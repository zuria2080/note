var htmlGlobalNB;!function(){function t(t,s,i){var a=t.numPost,n=t.tipoA,r=t.postit;if(0==t.X&&t.Y){t.X=$("html").scrollLeft()+Math.floor(500*Math.random()),t.Y=$("html").scrollTop()+Math.floor(500*Math.random());var d={numPost:a,left:t.X,top:t.Y};chrome.runtime.sendMessage({cambiaNota:d})}var l=document.createElement("postitNB");if("true"==t.sinMarco?n.length<3?l.innerHTML='<div id="postitNB'+a+'" class="postitsNB postitNB'+n+' ui-draggable postitSinMarco" ><div class="parteSuperior" id="parteSuperior'+a+'"><div class="bordesup" id="bordesup'+a+'"></div><div class="fondoIconos" id="fondoIconos'+a+'"></div><img class="pencilImg" id="pencilImg'+a+'" src="'+chrome.runtime.getURL("appimg/pencil.png")+'"/><button class="botonborrar" id="borr'+a+'"><span class="lid"></span><span class="can"></span></button></div><div class="fuenteNB'+s+'"  id="texto'+a+'">'+r+'</div><div class="clearfloat"></div></div>':l.innerHTML='<div id="postitNB'+a+'" class="postitsNB postitNB1 ui-draggable postitSinMarco" ><div class="parteSuperior" id="parteSuperior'+a+'"><div class="bordesup" id="bordesup'+a+'"></div><div class="fondoIconos" id="fondoIconos'+a+'"></div><img class="pencilImg" id="pencilImg'+a+'" src="'+chrome.runtime.getURL("appimg/pencil.png")+'"/><button class="botonborrar" id="borr'+a+'"><span class="lid"></span><span class="can"></span></button></div><div class="fuenteNB'+s+'"  id="texto'+a+'">'+r+'</div><div class="clearfloat"></div></div>':n.length<3?l.innerHTML='<div id="postitNB'+a+'" class="postitsNB postitNB'+n+' ui-draggable" ><div class="bordesup" id="bordesup'+a+'"></div><img class="pencilImg" id="pencilImg'+a+'" src="'+chrome.runtime.getURL("appimg/pencil.png")+'"/><button class="botonborrar" id="borr'+a+'"><span class="lid"></span><span class="can"></span></button><div class="fuenteNB'+s+'"  id="texto'+a+'">'+r+'</div><div class="clearfloat"></div></div>':l.innerHTML='<div id="postitNB'+a+'" class="postitsNB postitNB1 ui-draggable" ><div class="bordesup" id="bordesup'+a+'"></div><img class="pencilImg" id="pencilImg'+a+'" src="'+chrome.runtime.getURL("appimg/pencil.png")+'"/><button class="botonborrar" id="borr'+a+'"><span class="lid"></span><span class="can"></span></button><div class="fuenteNB'+s+'"  id="texto'+a+'">'+r+'</div><div class="clearfloat"></div></div>',document.body.appendChild(l),t.pushpin&&($("#postitNB"+a).append('<img class="pinImg" data-pushpin="'+t.pushpin+'" src="'+chrome.runtime.getURL("appimg/pushpins/pushpin"+t.pushpin+".png")+'" />'),$("#postitNB"+a).addClass("postitFixed")),80==n&&$("#postitNB"+a).removeClass("postit1").addClass("postit80").addClass("notepad"),$("#texto"+a).css({"font-size":i}),n.length>2){var p=function(t,e){(t=String(t).replace(/[^0-9a-f]/gi,"")).length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);e=e||0;var o,s,i="#";for(s=0;s<3;s++)o=parseInt(t.substr(2*s,2),16),i+=("00"+(o=Math.round(Math.min(Math.max(0,o+o*e),255)).toString(16))).substr(o.length);return i}(n,-.2);document.getElementById("postitNB"+a).style.background="linear-gradient(#"+n+", "+p+")"}null==t.userComp?$(".botonborrar > .can, .botonborrar > .lid").css("background",'url("'+chrome.runtime.getURL("appimg/remove.png")+'") 0 0 no-repeat'):($("#borr"+a).remove(),$("#bordesup"+a).height("25"),$("#bordesup"+a).html('<div class="friendsDiv"><img src="appimg/friends.png"><label>'+t.nickComp+"</label></div>"),"R"==t.userComp&&$("#pencilImg"+a).remove()),$("#postitNB"+a).draggable({scroll:!0,start:function(t,o){e(t,a)},stop:function(t,e){o(t,e,a)}}),t.Y<-50&&(t.Y=40+Math.floor(100*Math.random())),t.Y<-50&&(t.Y=100+Math.floor(100*Math.random())),"auto"==t.width?$("#postitNB"+a).width("auto"):$("#postitNB"+a).width(t.width+"px");var c=function(t){var e=0;return $("#texto"+t+" iframe").each((function(){var t=$(this).attr("src");null!=t&&t.indexOf("youtube.com/embed")>-1&&(e=$(this).width())})),e}(a);c>0&&c>t.width?$("#postitNB"+a).width(c):c>0&&c<t.width&&function(t,e){$("#texto"+t+" iframe").each((function(){var t=$(this).attr("src");null!=t&&t.indexOf("youtube.com/embed")>-1&&$(this).width(e),$(this).height(.5625*e)}))}(a,$("#postitNB"+a).width()),"true"!=t.sinMarco?($("#postitNB"+a).height("auto"),t.postit.indexOf("<img")>-1?$("#texto"+a+" img").each((function(){var e=new Image;e.onload=function(){$("#texto"+a).height()+30<t.height&&$("#postitNB"+a).height(t.height+"px")},e.src=$(this).attr("src")})):$("#texto"+a).height()+30<t.height&&$("#postitNB"+a).height(t.height+"px")):(document.getElementById("texto"+a).firstChild&&("A"==document.getElementById("texto"+a).firstChild.tagName&&"IMG"!=document.getElementById("texto"+a).firstChild.firstChild.tagName||"SPAN"==document.getElementById("texto"+a).firstChild.tagName&&"A"==document.getElementById("texto"+a).firstChild.firstChild.tagName&&"IMG"!=document.getElementById("texto"+a).firstChild.firstChild.firstChild.tagName)&&$("#texto"+a).prepend("<br>"),$("#bordesup"+a).height(0),$("#parteSuperior"+a).height(0),$("#texto"+a).height("auto"),setTimeout((function(){$("#texto"+a).height("auto"),$("#texto"+a).height()>50&&(document.getElementById("texto"+a).lastChild&&"IMG"==document.getElementById("texto"+a).lastChild.tagName?$("#texto"+a).height($("#texto"+a).height()-10):$("#texto"+a).height($("#texto"+a).height()))}),500),setTimeout((function(){$("#texto"+a).height("auto"),$("#texto"+a).height()>50&&(document.getElementById("texto"+a).lastChild&&"IMG"==document.getElementById("texto"+a).lastChild.tagName?$("#texto"+a).height($("#texto"+a).height()-10):$("#texto"+a).height($("#texto"+a).height()))}),2500)),$("#postitNB"+a).offset({top:t.Y,left:t.X}),parseInt(t.X)+$("#postitNB"+a).width()>window.innerWidth&&$("#postitNB"+a).offset({left:window.innerWidth-$("#postitNB"+a).width()-50}),t.pushpin&&(t.Y>$("html").scrollTop()+window.innerHeight||t.Y<$("html").scrollTop())&&$("#postitNB"+a).css({top:300}),$("#postitNB"+a).resizable({minHeight:40,minWidth:120,start:function(t,o){e(t,a)},stop:function(t,e){o(t,e,a)}}),"R"!=t.userComp&&$("#pencilImg"+a).on("click",(function(){var t=$("#postitNB"+a);chrome.runtime.sendMessage({editaNota:t.attr("id"),posX:t.offset().left,posY:t.offset().top-$("html").scrollTop(),notaWidth:t.width(),notaHeight:t.height()}),t.remove()})),null!=t.width&&"undefined"!=t.width||(t.width=$("#postitNB"+a).width()),null!=t.height&&"undefined"!=t.height&&"0"!=t.height||($("#postitNB"+a).height("auto"),t.height=$("#postitNB"+a).height()),function(t,e){$("#postitNB"+t).on("dblclick",(function(){chrome.runtime.sendMessage({editaNota:$(this).attr("id"),posX:$(this).offset().left,posY:$(this).offset().top-$("html").scrollTop(),notaWidth:$(this).width(),notaHeight:$(this).height()}),$(this).remove()})),$("#borr"+t).on("click",(function(){var t=parseInt($(this).attr("id").substr(4));$("#postitNB"+t).fadeOut();var e={numPost:t};chrome.runtime.sendMessage({borraNota:e})})),$("#postitNB"+t).find(".ui-resizable-se").hide(),$("#postitNB"+t).on("mouseover",(function(){$(this).find(".ui-resizable-se").show(),$(this).find(".botonborrar").show(),$(this).find(".pencilImg").show(),e.tipoA.length>2&&$("#bordesup"+t).addClass("bordeHover"),"true"==e.sinMarco&&$("#parteSuperior"+t).show()})),$("#postitNB"+t).on("mouseleave",(function(){$(this).find(".ui-resizable-se").hide(),$(this).find(".botonborrar").hide(),$(this).find(".pencilImg").hide(),e.tipoA.length>2&&$("#bordesup"+t).removeClass("bordeHover"),"true"==e.sinMarco&&$("#parteSuperior"+t).hide()}))}(a,t),t.rotacion&&(document.getElementById("postitNB"+a).style.webkitTransform="rotate("+t.rotacion+"deg)")}function e(t,e){$(t.target).css("z-index","1000001"),$(t.target).css("-webkit-box-shadow","0px 15px 20px rgba(0, 0, 0, 0.5)"),$(t.target).find(".pinImg").css("opacity","0.5")}function o(t,e,o){$(t.target).css("-webkit-box-shadow","0px 5px 10px rgba(0, 0, 0, 0.5)"),$(t.target).css("z-index","1000"),$(".fondoIconos").css("z-index","0"),$(t.target).find(".pinImg").css("opacity","1");var s={numPost:o,left:$("#postitNB"+o).offset().left,top:$("#postitNB"+o).offset().top,width:$("#postitNB"+o).width(),height:$("#postitNB"+o).height()};chrome.runtime.sendMessage({cambiaNota:s})}function s(t){var e=$(t.target).closest(".postitsNB");e.length>0?e.css("opacity","0.6"):$("postitnb").css("opacity","1"),t.stopPropagation(),t.preventDefault()}function i(t){0==$(t.target).closest(".postitsNB").length&&$("postitnb").css("opacity","1"),t.stopPropagation(),t.preventDefault()}function a(t){if(t.stopPropagation(),t.preventDefault(),$("postitNB").css("opacity","1"),(e=$(t.target).closest(".postitsNB")).length>0){var e,o=t.dataTransfer.getData("text/html");if(o==htmlGlobalNB)return;if(htmlGlobalNB=o,0==o.length&&(o=t.dataTransfer.getData("Text")),(e=$(t.target).closest("postitnb")).length>0)!function(t,e){$("#texto"+e).append(t);var o={numPost:e,html:t};chrome.runtime.sendMessage({adjuntaHtml:o}),chrome.runtime.sendMessage({dameNotas:"dameNotas"})}(o,e.children().attr("id").substr(8))}}chrome.runtime.sendMessage({dameNotas:"dameNotas"}),chrome.runtime.onMessage.addListener((function(e,o){if(e.objetoEnvio){$(".postitsNB").remove();var s=JSON.parse(e.objetoEnvio);!function(t){var e="";switch(t){case"1":e="https://fonts.googleapis.com/css?family=Kalam:400normal&subset=all";break;case"2":e="https://fonts.googleapis.com/css?family=Droid+Sans";break;case"3":e="https://fonts.googleapis.com/css?family=Architects+Daughter:400normal&subset=all";break;case"4":e="https://fonts.googleapis.com/css?family=Quando:400normal&subset=all";break;case"5":e="https://fonts.googleapis.com/css?family=Indie+Flower";break;case"6":e="https://fonts.googleapis.com/css?family=Quattrocento+Sans:400,700&subset=all";break;case"7":e="https://fonts.googleapis.com/css?family=Montserrat:400normal&subset=all";break;case"8":e="https://fonts.googleapis.com/css?family=Roboto&display=swap";break;case"9":e="https://fonts.googleapis.com/css?family=Karla&display=swap"}var o=document.createElement("link");o.type="text/css",o.rel="stylesheet",o.href=e,(document.body||document.head||document.documentElement).appendChild(o),(o=document.createElement("link")).type="text/css",o.rel="stylesheet",o.href=chrome.runtime.getURL("jquery/jquery-ui.min.css"),(document.body||document.head||document.documentElement).appendChild(o)}(s.fuente);for(var i=0;i<s.listaNotas.length;i++)t(s.listaNotas[i],s.fuente,s.sizef)}e.muestraNotas&&chrome.runtime.sendMessage({dameNotas:"dameNotas"})})),document.removeEventListener("dragover",s),document.addEventListener("dragover",s,!1),document.removeEventListener("dragleave",i),document.addEventListener("dragleave",i,!1),document.removeEventListener("drop",a),document.addEventListener("drop",a,!1)}();