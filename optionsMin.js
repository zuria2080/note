!function(e,t){function o(e){for(var t=0;t<i.bundles.length;t++)for(var o in i.bundles[t])if(o!=e&&v(i.bundles[t][o],e)>-1)return o}function a(e){for(var t,o=0;t=i.matchers[o];o++){var a=t[0],n=t[1];if(e.match(a))return n(e)}throw new Error(e+" was not recognised by loader")}function n(e,t){for(var o,i=[],r=0;o=e[r];r++)"string"==typeof o&&(o=a(o)),R(o)&&(o=new g(n(o,t),t)),i.push(o);return i}function i(){var e,t,o=S(arguments);"function"==typeof o[o.length-1]&&(e=o.pop()),"boolean"==typeof o[o.length-1]&&(t=o.pop());var a=new p(n(o,t),t);return e&&a.then(e),a}function r(){var e,t,o=S(arguments),a=[];return"string"==typeof o[0]&&(e=o.shift()),R(o[0])&&(a=o.shift()),t=o.shift(),d(e,(function(e){function o(){var o,i=l(S(a),n);void 0===(o="function"==typeof t?t.apply(n,i):t)&&(o=n.exports),e(o)}for(var n=this,r=[],c=0,d=a.length;c<d;c++){var u=a[c];-1==v(["require","exports"],u)&&r.push(s(u,n))}r.length>0?i.apply(this,r.concat(o)):o()}))}function l(e,t){function o(e){return m.exports[s(e,t)]}for(var a=[],n=0,i=e.length;n<i;n++)"require"!=e[n]?"exports"!=e[n]?a.push(o(e[n])):(t.exports=t.exports||{},a.push(t.exports)):a.push(o);return a}function s(e,t){var o=(t.id||"").split("/");o.pop();var a=o.join("/");return e.replace(/^\./,a)}function c(){var e,t=S(arguments);return"string"==typeof t[0]&&(e=t.shift()),d(e,t.shift())}function d(e,t){var o;return!e&&I&&(o=x||u()),o?(delete O[o.scriptId],o.body=t,o.execute()):(C=o=new m(e,t),A[o.id]=o),o}function u(){for(var e in $)if("interactive"==$[e].readyState)return O[$[e].id]}function g(e,t){this.deps=e,this.collectResults=t}function p(e,t){this.deps=e,this.collectResults=t,0==this.deps.length&&this.complete()}function m(e,t){this.id=e,this.body=t,void 0===t&&(this.path=this.resolvePath(e))}function b(e,t){this.id=this.path=e,this.force=!!t}function h(){}function f(e,t,o){for(var a=t.split("/"),n=e;a.length>1;){var i=a.shift();n=n[i]=n[i]||{}}n[a[0]]=o}function v(e,t){for(var o,a=0;o=e[a];a++)if(t==o)return a;return-1}function S(e){return Array.prototype.slice.call(e)}function w(e){for(var t,o=1;t=arguments[o];o++)for(var a in t)e[a]=t[a];return e}for(var y,C,x,k,I=e.attachEvent&&!e.opera,$=t.getElementsByTagName("script"),T=0,N=t.createElement("script"),P={},A={},O={},M=e.using,E=e.provide,_=e.define,B=e.loadrunner,L=0;k=$[L];L++)if(k.src.match(/loadrunner\.js(\?|#|$)/)){y=k;break}var R=Array.isArray||function(e){return e.constructor==Array};h.prototype.then=function(t){return this.started||(this.started=!0,this.start()),this.completed?t.apply(e,this.results):(this.callbacks=this.callbacks||[],this.callbacks.push(t)),this},h.prototype.start=function(){},h.prototype.complete=function(){if(!this.completed&&(this.results=S(arguments),this.completed=!0,this.callbacks))for(var t,o=0;t=this.callbacks[o];o++)t.apply(e,this.results)},b.loaded=[],b.prototype=new h,b.prototype.start=function(){var e,t,a,n=this;return(a=A[this.id])?(a.then((function(){n.complete()})),this):((e=P[this.id])?e.then((function(){n.loaded()})):!this.force&&v(b.loaded,this.id)>-1?this.loaded():(t=o(this.id))?i(t,(function(){n.loaded()})):this.load(),this)},b.prototype.load=function(){var t=this;P[this.id]=t;var o=N.cloneNode(!1);this.scriptId=o.id="LR"+ ++T,o.type="text/javascript",o.async=!0,o.onerror=function(){throw new Error(t.path+" not loaded")},o.onreadystatechange=o.onload=function(o){("load"==(o=e.event||o).type||v(["loaded","complete"],this.readyState)>-1)&&(this.onreadystatechange=null,t.loaded())},o.src=this.path,x=this,$[0].parentNode.insertBefore(o,$[0]),x=null,O[o.id]=this},b.prototype.loaded=function(){this.complete()},b.prototype.complete=function(){-1==v(b.loaded,this.id)&&b.loaded.push(this.id),delete P[this.id],h.prototype.complete.apply(this,arguments)},m.exports={},m.prototype=new b,m.prototype.resolvePath=function(e){return function(){for(var e=S(arguments),t=[],o=0,a=e.length;o<a;o++)e[o].length>0&&t.push(e[o].replace(/\/$/,""));return t.join("/")}(i.path,e+".js")},m.prototype.start=function(){var e,t,a=this;this.body?this.execute():(e=m.exports[this.id])?this.exp(e):(t=A[this.id])?t.then((function(e){a.exp(e)})):(bundle=o(this.id))?i(bundle,(function(){a.start()})):(A[this.id]=this,this.load())},m.prototype.loaded=function(){var e,t,o=this;I?(t=m.exports[this.id])?this.exp(t):(e=A[this.id])&&e.then((function(e){o.exp(e)})):(e=C,C=null,e.id=e.id||this.id,e.then((function(e){o.exp(e)})))},m.prototype.complete=function(){delete A[this.id],b.prototype.complete.apply(this,arguments)},m.prototype.execute=function(){var e=this;"object"==typeof this.body?this.exp(this.body):"function"==typeof this.body&&this.body.apply(window,[function(t){e.exp(t)}])},m.prototype.exp=function(e){this.complete(this.exports=m.exports[this.id]=e||{})},p.prototype=new h,p.prototype.start=function(){function e(){var e=[];o.collectResults&&(e[0]={});for(var t,a=0;t=o.deps[a];a++){if(!t.completed)return;t.results.length>0&&(o.collectResults?t instanceof g?w(e[0],t.results[0]):f(e[0],t.id,t.results[0]):e=e.concat(t.results))}o.complete.apply(o,e)}for(var t,o=this,a=0;t=this.deps[a];a++)t.then(e);return this},g.prototype=new h,g.prototype.start=function(){var e=this,t=0,o=[];return e.collectResults&&(o[0]={}),function a(){var n=e.deps[t++];n?n.then((function(t){n.results.length>0&&(e.collectResults?n instanceof g?w(o[0],n.results[0]):f(o[0],n.id,n.results[0]):o.push(n.results[0])),a()})):e.complete.apply(e,o)}(),this},r.amd={};var z=function(e){return e(i,c,z,define)};z.Script=b,z.Module=m,z.Collection=p,z.Sequence=g,z.Dependency=h,z.noConflict=function(){return e.using=M,e.provide=E,e.define=_,e.loadrunner=B,z},e.loadrunner=z,e.using=i,e.provide=c,e.define=r,i.path="",i.matchers=[],i.matchers.add=function(e,t){this.unshift([e,t])},i.matchers.add(/(^script!|\.js$)/,(function(e){var t=new b(e.replace(/^\$/,i.path.replace(/\/$/,"")+"/").replace(/^script!/,""),!1);return t.id=e,t})),i.matchers.add(/^[a-zA-Z0-9_\-\/]+$/,(function(e){return new m(e)})),i.bundles=[],y&&(i.path=y.getAttribute("data-path")||y.src.split(/loadrunner\.js/)[0]||"",(main=y.getAttribute("data-main"))&&i.apply(e,main.split(/\s*,\s*/)).then((function(){})))}(this,document),window.__twttrlr=loadrunner.noConflict(),__twttrlr((function(e,t,o,a){t("util/iframe",(function(e){var t=document.createElement("div");e((function(e){t.innerHTML='<iframe src="'+e.url+'" allowtransparency="true" frameborder="0" scrolling="no"/>';var o=t.firstChild.cloneNode(!1);for(var a in o.src=e.url,o.className=e.className||"",e.css)o.style[a]=e.css[a];(o.title=e.title||"",e.replace)?e.replace.parentNode.replaceChild(o,e.replace):document.body.insertBefore(o,document.body.firstChild);return o}))})),t("util/querystring",(function(e){function t(e){var t=[];for(var o in e)null!==e[o]&&void 0!==e[o]&&t.push(a(o)+"="+a(e[o]));return t.sort().join("&")}function o(e){return decodeURIComponent(e)}function a(e){return encodeURIComponent(e).replace(/\+/g,"%2B")}e({url:function(e,o){return t(o).length>0?e.indexOf("?")>=0?e+"&"+t(o):e+"?"+t(o):e},decode:function(e){var t,a,n,i,r={};if(e)for(t=e.split("&"),i=0;n=t[i];i++)2==(a=n.split("=")).length&&(r[o(a[0])]=o(a[1]));return r},encode:t,encodePart:a,decodePart:o})})),t("util/nodeselect",(function(e){var t=document,o="querySelectorAll"in t?function(e,o){return t.querySelectorAll(e+"."+o)}:"getElementsByClassName"in t?function(e,o){var a,n=t.getElementsByClassName(o),r=[];for(i=0;a=n[i];i++)a.tagName.toLowerCase()==e&&r.push(a);return r}:function(e,o){var a,n=t.getElementsByTagName(e),r=new RegExp("(?:^|\\s+)"+o+"(?:\\s+|$)"),l=[];for(i=0;a=n[i];i++)r.test(a.className)&&l.push(a);return l};e(o)})),t("$vendor/domready/ready.js",(function(e){!function(e){function t(){n=1;for(var e=0,t=i.length;e<t;e++)i[e]()}var o,a,n=0,i=[],r=e.createElement("a"),l="DOMContentLoaded",s="addEventListener",c="onreadystatechange";/^loade|c/.test(e.readyState)&&(n=1),e[s]&&e[s](l,a=function(){e.removeEventListener(l,a,false),t()},false),r.doScroll&&e.attachEvent(c,o=function(){/^c/.test(e.readyState)&&(e.detachEvent(c,o),t())});var d=r.doScroll?function(e){self!=top?n?e():i.push(e):function(){try{r.doScroll("left")}catch(t){return setTimeout((function(){d(e)}),50)}e()}()}:function(e){n?e():i.push(e)};"undefined"!=typeof module&&module.exports?module.exports={domReady:d}:window.domReady=d}(document),e(),o.Script.loaded.push("$vendor/domready/ready.js")})),t("util/domready",(function(t){e("$vendor/domready/ready.js",(function(){t(domReady)}))})),t("util/util",(function(e){function t(e){for(var t,o=1;t=arguments[o];o++)for(var a in t)e[a]=t[a];return e}e({aug:t,array:function(e){return t([],e)},indexOf:function(e,t){for(var o,a=0;o=e[a];a++)if(t==o)return a;return-1}})})),t("tfw/widget/base",(function(t){e("util/util","util/domready","util/nodeselect","util/querystring","util/iframe",(function(e,o,a,n,i){function r(){var e,t,o=l.widgets;for(var n in o){e=n.match(/\./)?a.apply(this,n.split(".")):document.getElementsByTagName(n);for(var i,r=0;i=e[r];r++)t=new o[n](i),c.list.push(t),c.byId[t.id]=t,t.render(l)}}var l,s=0,c={list:[],byId:{}},d=function(){};e.aug(d.prototype,{_:function(e){var t=this.lang;return t&&this.langs.hasOwnProperty(t)||(t="en"),this.langs[t][e]},add:function(e){c.list.push(this),c.byId[this.id]=e},create:function(e,t,o,a){return this.id=this.generateId(),i({url:e,css:{width:o[0]+("string"!=typeof o[0]?"px":""),height:o[1]+("string"!=typeof o[1]?"px":"")},className:t,id:this.id,title:a,replace:this.originElement})},params:function(){var e=this.originElement.href&&this.originElement.href.split("?")[1];return e?n.decode(e):{}},generateId:function(){return this.originElement.id?this.originElement.id:"twitter_tweet_button_"+s++}}),t({Base:d,init:function(e){l=e},embed:function(){r(),o((function(){r()}))},find:function(e){return e&&c.byId[e]?c.byId[e].element:null},TWITTER_PROFILE_URL:/^https?\:\/\/(?:www\.)?twitter\.com\/(?:#!?\/)?([a-zA-Z0-9_]{1,20})\/?$/})}))})),t("util/events",(function(t){e("util/util",(function(e){function o(){this.completed=!1,this.callbacks=[]}var a={bind:function(e,t){return this._handlers=this._handlers||{},this._handlers[e]=this._handlers[e]||[],this._handlers[e].push(t)},unbind:function(t,o){if(this._handlers[t])if(o){var a=e.indexOf(this._handlers[t],o);a>=0&&this._handlers[t].splice(a,1)}else this._handlers[t]=[]},trigger:function(e,t){var o=this._handlers&&this._handlers[e];if(t.type=e,o)for(var a,n=0;a=o[n];n++)a.call(this,t)}};o.prototype.addCallback=function(e){this.completed?e.apply(this,this.results):this.callbacks.push(e)},o.prototype.complete=function(){this.results=makeArray(arguments),this.completed=!0;for(var e,t=0;e=this.callbacks[t];t++)e.apply(this,this.results)},t({Emitter:a,Promise:o})}))})),t("util/uri",(function(t){e("util/querystring","util/util",(function(e,o){function a(e){var t;return e.match(/^https?:\/\//)?e:(t=location.host,location.port.length>0&&(t+=":"+location.port),[location.protocol,"//",t,e].join(""))}t({absolutize:a,getCanonicalURL:function(){for(var e,t=document.getElementsByTagName("link"),o=0;e=t[o];o++)if("canonical"==e.getAttribute("rel"))return a(e.getAttribute("href"));return null},getScreenNameFromPage:function(){for(var e,t,a,n,i=document.getElementsByTagName("a"),r=document.getElementsByTagName("link"),l=/\bme\b/,s=/^https?\:\/\/(www\.)?twitter.com\/([a-zA-Z0-9_]+)$/,c=o.array(i).concat(o.array(r)),d=0;n=c[d];d++)if(t=n.getAttribute("rel"),a=n.getAttribute("href"),t&&a&&t.match(l)&&(e=a.match(s)))return e[2]}})}))})),t("tfw/widget/intent",(function(t){e("util/util","tfw/widget/base","util/querystring","util/uri",(function(o,a,n,i){function r(t){for(var o,a=(t=t||window.event).target||t.srcElement;a&&"a"!==a.nodeName.toLowerCase();)a=a.parentNode;if(a&&"a"===a.nodeName.toLowerCase()&&a.href&&a.href.match(s)){var n=function(e){var t="original_referer="+location.href;return[e,t].join(-1==e.indexOf("?")?"?":"&")}(a.href);n=(n=n.replace(/^http[:]/,"https:")).replace(/^\/\//,"https://"),twttr.events.hub?(o=new m(l.generateId(),a),l.add(o),function(t,o){e("xd/parent","xd/jsonrpc",(function(e,a){a(e.connect({window:{width:550,height:450},src:t})).expose({trigger:function(e,t){twttr.events.trigger(e,{target:o,region:"intent",type:e,data:t})}})}))}(n,a),twttr.events.trigger("click",{target:a,region:"intent",type:"click",data:{}})):function(e){var t=Math.round(p/2-d/2),o=0;g>u&&(o=Math.round(g/2-u/2)),window.open(e,"intent",c+",width="+d+",height="+u+",left="+t+",top="+o)}(n),t.returnValue=!1,t.preventDefault&&t.preventDefault()}}var l,s=/twitter\.com(\:\d{2,4})?\/intent\/(\w+)/,c="scrollbars=yes,resizable=yes,toolbar=no,location=yes",d=550,u=520,g=screen.height,p=screen.width,m=function(e,t){this.id=e,this.element=this.originElement=t},b=function(e){this.originElement=[],this.element=e};b.prototype=new a.Base,o.aug(b.prototype,{render:function(e){l=this,window.__twitterIntentHandler||(document.addEventListener?document.addEventListener("click",r,!1):document.attachEvent&&document.attachEvent("onclick",r),window.__twitterIntentHandler=!0)}}),t({Listener:b})}))})),t("tfw/widget/tweet",(function(t){e("util/util","tfw/widget/base","util/querystring","util/uri",(function(e,o,a,n){var i=document.title,r=encodeURI(location.href),l={en:1,de:1,es:1,fr:1,id:1,it:1,ko:1,ja:1,nl:1,pt:1,ru:1,tr:1},s=function(e){this.originElement=e,this.id=this.generateId();var t=this.params(),o=t.count||e.getAttribute("data-count"),a=t.lang||e.getAttribute("data-lang");this.text=t.text||e.getAttribute("data-text")||i,this.via=t.via||e.getAttribute("data-via")||n.getScreenNameFromPage(),this.url=t.url||e.getAttribute("data-url")||n.getCanonicalURL()||r,this.related=t.related||e.getAttribute("data-related"),this.counturl=t.counturl||e.getAttribute("data-counturl"),this.searchlink=t.searchlink||e.getAttribute("data-searchlink"),this.placeid=t.placeid||e.getAttribute("data-placeid"),this.dnt=t.dnt||e.getAttribute("data-dnt")||"",this.supportCount[o]||(o="horizontal"),this.count=o,l[a]||(a="en"),this.lang=a};s.prototype=new o.Base,e.aug(s.prototype,{supportCount:{vertical:1,horizontal:1,none:1},titles:{en:"Twitter For Websites: Tweet Button",de:"Twitter fÃ¼r Webseiten: Tweet-SchaltflÃ¤che",es:"Twi`tter para sitios web: BotÃ³n para Twittear",fr:'Twitter pour votre site web : bouton "Tweeter"',id:"Twitter untuk Situs Web: Tombol Tweet",it:"Tweeter per i siti web: Bottone Tweet",ja:"WEBã‚µã‚¤ãƒˆå‘ã‘Twitter: ãƒ„ã‚¤ãƒ¼ãƒˆãƒœã‚¿ãƒ³",ko:"Twitter ì›¹ë²„ì „: íŠ¸ìœ— ë²„íŠ¼",nl:"Twitter voor websites: tweetknop",pt:"Twitter para websites: BotÃ£o de Tweet",ru:"Ð¢Ð²Ð¸Ñ‚Ñ‚ÐµÑ€ Ð´Ð»Ñ Ð²ÐµÐ±-ÑÐ°Ð¹Ñ‚Ð°: ÐºÐ½Ð¾Ð¿ÐºÐ° Â«Ð¢Ð²Ð¸Ñ‚Ð½ÑƒÑ‚ÑŒÂ»",tr:"Web siteleri iÃ§in Twitter: Tweetle Butonu"},dimensionsMap:{en:{vertical:[55,62],horizontal:[110,20],none:[55,20]},de:{vertical:[67,62],horizontal:[122,20],none:[67,20]},es:{vertical:[64,62],horizontal:[118,20],none:[64,20]},fr:{vertical:[65,62],horizontal:[118,20],none:[65,20]},id:{vertical:[55,62],horizontal:[110,20],none:[55,20]},it:{vertical:[55,62],horizontal:[110,20],none:[55,20]},ko:{vertical:[55,62],horizontal:[110,20],none:[55,20]},ja:{vertical:[80,62],horizontal:[130,20],none:[80,20]},nl:{vertical:[55,62],horizontal:[110,20],none:[55,20]},pt:{vertical:[66,62],horizontal:[120,20],none:[66,20]},ru:{vertical:[68,62],horizontal:[120,20],none:[68,20]},tr:{vertical:[66,62],horizontal:[120,20],none:[66,20]}},parameters:function(){var e={text:this.text,url:this.url,via:this.via,related:this.related,count:this.count,lang:this.lang,counturl:this.counturl,searchlink:this.searchlink,placeid:this.placeid,original_referer:location.href,id:this.id,dnt:this.dnt};return e._=(new Date).getTime(),a.encode(e)},render:function(e){var t=e.assetUrl()+"/widgets/tweet_button.html#"+this.parameters(),o=this.dimensionsMap[this.lang][this.count],a=this.titles[this.lang];this.element=this.create(t,"twitter-share-button twitter-count-"+this.count,o,a)}}),t({Embeddable:s})}))})),t("tfw/widget/follow",(function(t){e("util/util","tfw/widget/base","util/querystring","util/uri",(function(e,o,a,n){var i={en:1,de:1,es:1,fr:1,id:1,it:1,ko:1,ja:1,nl:1,pt:1,ru:1,tr:1},r=function(e){this.originElement=e,this.id=this.generateId();var t=this.params(),o=t.lang||e.getAttribute("data-lang")||"en";this.showScreenName=t.show_screen_name||e.getAttribute("data-show-screen-name")||"",this.showCount=t.show_count||e.getAttribute("data-show-count")||"",this.button=t.button||e.getAttribute("data-button")||"blue",this.linkColor=t.link_color||e.getAttribute("data-link-color")||"",this.textColor=t.text_color||e.getAttribute("data-text-color")||"",this.width=t.width||e.getAttribute("data-width")||"",this.screenName=this.screenNameFromHref(),this.align=t.align||e.getAttribute("data-align")||"",this.lang=o,this.dnt=t.dnt||e.getAttribute("data-dnt")||"",i[o]||(this.lang="en")};r.prototype=new o.Base,e.aug(r.prototype,{titles:{en:"Twitter For Websites: Tweet Button",de:"Twitter fÃ¼r Webseiten: Tweet-Folgen",es:"Twi`tter para sitios web: BotÃ³n para Seguir",fr:'Twitter pour votre site web : bouton "Suivre"',id:"",it:"Tweeter per i siti web: Bottone Seguire",ja:"WEBã‚µã‚¤ãƒˆå‘ã‘Twitter",ko:"Twitter ì›¹ë²„ì „",pt:"Twitter para websites",ru:"Ð¢Ð²Ð¸Ñ‚Ñ‚ÐµÑ€ Ð´Ð»Ñ Ð²ÐµÐ±-ÑÐ°Ð¹Ñ‚Ð°",tr:"Web siteleri iÃ§in Twitter"},langs:{en:{dimensions:[300,20]},de:{dimensions:[300,20]},es:{dimensions:[300,20]},fr:{dimensions:[300,20]},id:{dimensions:[300,20]},it:{dimensions:[300,20]},ko:{dimensions:[300,20]},nl:{dimensions:[300,20]},pt:{dimensions:[300,20]},ja:{dimensions:[300,20]},ru:{dimensions:[300,20]},tr:{dimensions:[300,20]}},parameters:function(){var e={screen_name:this.screenName,lang:this.lang,button:this.button,link_color:this.linkColor,text_color:this.textColor,show_count:this.showCount,show_screen_name:this.showScreenName,align:this.align,id:this.id,dnt:this.dnt};return e._=(new Date).getTime(),a.encode(e)},screenNameFromHref:function(){var e;if(e=this.originElement.href.match(o.TWITTER_PROFILE_URL))return e[1]},render:function(e){if(this.screenName){var t=e.assetUrl()+"/widgets/follow_button.html#"+this.parameters(),o=this.langs[this.lang].dimensions;this.width&&(o=[this.width,o[1]]);var a=this.langs[this.lang].title;this.element=this.create(t,"twitter-follow-button",o,a)}}}),t({Embeddable:r})}))})),window.twttr=window.twttr||{},function(){twttr.host=twttr.host||"platform.twitter.com",0==e.path.length&&(e.path="//"+twttr.host+"/js"),void 0===twttr.ignoreSSL&&(twttr.ignoreSSL=!1);var t=[];twttr.events={bind:function(e,o){return t.push([e,o])}},e("util/util","tfw/widget/follow","tfw/widget/tweet","tfw/widget/intent","util/events","tfw/widget/base",(function(o,a,n,i,r,l){var s={};s.widgets={"a.twitter-share-button":n.Embeddable,"a.twitter-follow-button":a.Embeddable,body:i.Listener},s.assetUrl=function(e){return function(e){return!window.location.protocol.match(/s\:$/)&&!e||twttr.ignoreSSL?"http":"https"}(e)+"://"+twttr.host},twttr.events=o.aug({},r.Emitter),twttr.events.oldbind=twttr.events.bind,twttr.events.bind=function(t,o){e("xd/parent","xd/jsonrpc",(function(e,t){var o=s.assetUrl()+"/widgets/hub.html";twttr.events.hub=e.connect({src:o,iframe:{name:"twttrHubFrame",style:"position:absolute;top:-9999em;width:10px;height:10px"}}),t(twttr.events.hub).expose({trigger:function(e,t,o){var a=(t=t||{}).region;delete t.region,twttr.events.trigger(e,{target:l.find(o),data:t,region:a,type:e})}})})),this.bind=this.oldbind,this.bind(t,o)};for(var c=0;handler=t[c];c++)twttr.events.bind(handler[0],handler[1]);twttr.widgets={load:function(){l.init(s),l.embed()}},twttr.widgets.load()}))}()})),function(e){e.fn.jsocial=function(t){t=e.extend({twitter:null,facebook:null,flickr:null,friendfeed:null,delicious:null,digg:null,gplus:null,linked:null,youtube:null,feed:null,newPage:null,center:!1,inline:!1,small:!1},t);return this.each((function(){if(t.newPage)var o='target="_blank"';var a=e(this),n=0,i='<ul class = "social_links">';t.twitter&&(i+='<li><a href="http://twitter.com/'+t.twitter+'" class="twitter" '+o+">Twitter</a></li>",n++),t.facebook&&(i+='<li><a href="http://'+t.facebook+'" class="facebook" '+o+" >Facebook</a></li>",n++),t.flickr&&(i+='<li><a href="http://flickr.com/'+t.flickr+'" class="flickr" '+o+" >Flickr</a></li>",n++),t.friendfeed&&(i+='<li><a href="http://friendfeed.com/'+t.friendfeed+'" class="friendfeed" '+o+" >FriendFeed</a></li>",n++),t.delicious&&(i+='<li><a href="http://delicious.com/'+t.delicious+'" class="delicious" '+o+" >Delicious</a></li>",n++),t.digg&&(i+='<li><a href="http://digg.com/users/'+t.digg+'" class="digg" '+o+" >Digg</a></li>",n++),t.gplus&&(i+='<li><a href="https://plus.google.com/'+t.gplus+'" class="gplus" '+o+" >Google Plus</a></li>",n++),t.linked&&(i+='<li><a href="http://'+t.linked+'" class="linked-in" '+o+" >Linked-In</a></li>",n++),t.youtube&&(i+='<li><a href="http://'+t.youtube+'" class="youtube" '+o+" >YouTube</a></li>",n++),t.feed&&(i+='<li><a href="http://feeds.feedburner.com/'+t.feed+'" class="feed" '+o+" >Feedburner</a></li>",n++),i+="</ul>",a.append(i),t.inline&&e("ul.social_links li").css("float","left"),t.small&&e(this).removeClass("social").addClass("social_small"),t.center&&(t.small?e("ul.social_links").css("width",26*n):e("ul.social_links").css("width",42*n))}))}}(jQuery);const VALORES_POR_DEFECTO={BOARD_HEIGTH:2e3,TEMA:"colorGris",FONDO:"50",TABLONACTUAL:"1",FUENTE:"6",FONT_SIZE:"15px",MIN_WIDTH_NOTA:"270px",MIN_WIDTH_EDITANDO_NOTA:"590px",DIR_IMAGENES:"appimg/",NUEVA_NOTA:"nuevopost",KANBAN_HEIGHT:600},WEBNOTES_BOARD=-999,TIPO_NOTA={TABLONES:"9",BLANCO:"10",AMARILLO:"1",VERDE:"2",LILA:"3",AMARILLO2:"4",ROSA:"5",ROJO:"6",AZUL:"7",TRANSPARENTE:"8",LIBRETA:"80"},TIPOS_NOTAS_RANDOM=[TIPO_NOTA.BLANCO,TIPO_NOTA.AMARILLO,TIPO_NOTA.VERDE,TIPO_NOTA.LILA,TIPO_NOTA.AMARILLO2,TIPO_NOTA.ROSA,TIPO_NOTA.ROJO,TIPO_NOTA.AZUL],CALIDAD_CAPTURAS_PANTALLA={local:20,logged:70},NOTAS_MINIMIZADAS={height:50,width:200},TOP_BAR={NONE:"none",BUTTONS_UP:"buttons_up",BUTTONS_DOWN:"buttons_down",BOARDS:"boards"},DEMO_USERS=["4156","412833","214973","615023"],BUG_IDEAS_USER="615023",GOOGLE_CLIENT_ID_EDGE_DEV="409932428860-ccanb86ttarambra11kvigdd09m8e0i2.apps.googleusercontent.com",GOOGLE_CLIENT_ID_EDGE_PRO="409932428860-s4cdpc3b4dli4jhekvlv6knb71e6araa.apps.googleusercontent.com",GOOGLE_CLIENT_ID_CHROME_PRO="409932428860-5a35icpm6o2quue6r60a91rac5oqmqc8.apps.googleusercontent.com",EDGE_ID_DEV="bjandjchhgibkhdhbfkpoccciebajadj",EDGE_ID_PRO="ehnmbncdeiinoaojbfjldmghkhjhlkli",CHROME_ID_PRO="goficmpcgcnombioohjcgdhbaloknabb",MAX_CHROME_LOCAL_STORAGE_SIZE=524e4,CANVAS_WIDTH={mini:80,normal:125},fondosTablones=[{id:"50",color:"#ececec",className:"fondo50",visible:!0},{id:"0",imagen:"corcho.jpg",className:!1,color:!1,visible:!0},{id:"51",imagen:"patterns/pat15.jpg",visible:!0},{id:"1",imagen:"corcho3.jpg",visible:!0},{id:"2",imagen:"corcho4.jpg",visible:!1},{id:"29",imagen:"patterns/pat7.png",visible:!0},{id:"3",imagen:"cemento.jpg",visible:!1},{id:"24",imagen:"patterns/pat2.png",visible:!0},{id:"41",imagen:"fondos/shattered-island.gif",visible:!0},{id:"6",imagen:"ladrillos.jpg",visible:!1},{id:"7",imagen:"carton.jpg",visible:!0},{id:"9",imagen:"cuero2.jpg",visible:!1},{id:"10",imagen:"malla.jpg",visible:!1},{id:"11",imagen:"cuero.jpg",visible:!1},{id:"12",imagen:"fondoS1.jpg",visible:!1},{id:"13",imagen:"hixs_pattern_evolution.png",visible:!1},{id:"14",color:"#6C8136",className:"fondo14",visible:!1},{id:"15",color:"#1a1a1a",className:"fondo15",visible:!1},{id:"16",color:"#C80000",className:"fondo16",visible:!1},{id:"17",color:"#961C1C",className:"fondo17",visible:!1},{id:"18",color:"#b03",className:"fondo18",visible:!1},{id:"19",color:"#fff",className:"fondo19",visible:!1},{id:"21",imagen:"patterns/vintage-concrete.png",visible:!0},{id:"22",imagen:"flores.jpg",visible:!0},{id:"27",imagen:"patterns/pat5.png",visible:!1},{id:"30",imagen:"patterns/pat8.png",visible:!0},{id:"31",imagen:"patterns/pat9.png",visible:!0},{id:"34",imagen:"patterns/pat12.png",visible:!0},{id:"37",color:"#ededee",className:"fondo37",visible:!0},{id:"4",imagen:"madera.jpg",visible:!0},{id:"33",imagen:"patterns/pat11.png",visible:!0},{id:"35",imagen:"patterns/pat13.png",visible:!0},{id:"5",imagen:"purty_wood.png",visible:!0},{id:"26",imagen:"patterns/pat4.png",visible:!0},{id:"38",imagen:"fondos/alchemy.gif",visible:!0},{id:"40",imagen:"fondos/science.png",visible:!0},{id:"42",imagen:"patterns/intersection.png",visible:!0},{id:"44",imagen:"patterns/doodles.png",visible:!0},{id:"46",imagen:"patterns/playstation-pattern.png",visible:!0},{id:"47",imagen:"patterns/random_grey_variations.png",visible:!0},{id:"48",imagen:"fondos/motherboard.jpg",visible:!0},{id:"23",imagen:"manutsi.jpg",visible:!0},{id:"49",imagen:"fondos/matrix.jpg",visible:!0},{id:"100",imagen:"rejilla.jpg",visible:!0},{id:"20",imagen:"papelArrugado.jpg",visible:!0},{id:"8",imagen:"fuego.jpg",visible:!0},{id:"52",imagen:"fondos/colorBrick.jpg",visible:!0},{id:"53",imagen:"fondos/pexels.jpg",visible:!0},{id:"54",imagen:"fondos/abstract.jpg",visible:!0},{id:"55",imagen:"fondos/pintura.jpg",visible:!0}];function isChromeExtension(){return document.URL.indexOf("chrome-extension")>-1}function isEdgeExtension(){return document.URL.indexOf(EDGE_ID_DEV)>-1||document.URL.indexOf(EDGE_ID_PRO)>-1}function isEdgePro(){return document.URL.indexOf(EDGE_ID_PRO)>-1}function isChromePro(){return document.URL.indexOf(CHROME_ID_PRO)>-1}function isEdgeBrowser(){return navigator.userAgent.toLowerCase().indexOf("edg")>-1}function isMobile(){return/iphone|ipod|ipad|android|ie|blackberry|fennec/.test(navigator.userAgent.toLowerCase())}function isIOS(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function isSmallScreen(){return window.innerWidth<=1e3}function isDemoUser(e){return!(isChromeExtension()||isEdgeExtension())&&DEMO_USERS.indexOf(localStorage.id_usuario)>-1&&!(e&&"6"===tablonActual&&esTablonKanban()&&"0"===localStorage["columnaKanban"+e]||e&&isBugsIdeasUser()&&("0"===localStorage["columnaKanban"+e]||"1"===localStorage["columnaKanban"+e]))}function isBugsIdeasUser(){return!(isChromeExtension()||isEdgeExtension())&&"615023"===localStorage.id_usuario}function isKanbanBugsBoard(){return isDemoUser()&&"6"===tablonActual&&esTablonKanban()||isBugsIdeasUser()}if(!isChromeExtension()){var chrome=chrome||{};chrome.permissions={},chrome.permissions.request=function(e,t){console.log(e),t&&t(!0)},chrome.permissions.contains=function(e,t){console.log(e),t&&t(!0)},chrome.i18n={},chrome.i18n.getMessage=function(e){return getMessage(e)},chrome.runtime={onMessage:{addListener:function(e){window.addEventListener("storage",(function(t){if("eventMessage"==t.key)try{console.log(localStorage.eventMessage),e(JSON.parse(localStorage.eventMessage))}catch(e){console.log(e)}}),!1),document.addEventListener("NoteBoardMessage",(t=>{e(t.detail)}))}},sendMessage:function(e){e={...e,noCache:(new Date).getTime()},localStorage.setItem("eventMessage",JSON.stringify(e)),document.dispatchEvent(new CustomEvent("NoteBoardMessage",{detail:{...e}}))},getURL:e=>(!isChromeExtension()&&e.indexOf("popup2.html")>-1&&(e=e.replace(".html",".php")),e),setUninstallURL:()=>{}},chrome.action={setBadgeText:()=>{},setTitle:()=>{},onClicked:{addListener:()=>{}}},chrome.windows={getAll:function(e){},onRemoved:{addListener:e=>{$(window).on("unload",(function(){e()}))}},create:function(e,t){var o=`toolbar=yes,scrollbars=yes,resizable=yes,top=${e.top},left=${e.left},width=${e.width},height=${e.height}`;window.open(e.url,"_blank",o).onload=t},update:(e,{width:t,height:o})=>{console.log(e),console.log(t),console.log(o)},getCurrent:()=>{}},chrome.tabs={create:function(e){window.open(e.url,"_blank")},onUpdated:{addListener:()=>{}},onRemoved:{addListener:()=>{}},onCreated:{addListener:()=>{}}},chrome.alarms={create:()=>{},onAlarm:{addListener:()=>{}}},chrome.extension={getBackgroundPage:function(){return{asignaNumeroTablon:asignaNumeroTablon,errorConexion:errorConexion,empiezaSincroPeriodica:empiezaSincroPeriodica,cierraPopup:cierraPopup,irAnotaPopup:irAnotaPopup}}},chrome.commands={onCommand:{addListener:()=>{}}},chrome.contextMenus={removeAll:()=>{},onClicked:{addListener:()=>{}}},getLocalStorage=async function(){return new Promise((e=>{e()}))},setAllLocalStorage=async function(){return new Promise((e=>{e()}))},setLocalStorage=async function(){return new Promise((e=>{e()}))}}function getServerUrl(){return isChromeExtension()?"https:/www.noteboardapp.com/":""}function isMovilApp(){return!1}function HayEspacios(e){return e.indexOf(" ")>-1}function cambiaContador(){var e=0;switch(null!=localStorage.contador&&"undefined"!=localStorage.contador||(localStorage.contador="1"),localStorage.contador){case"1":for(i=0;i<localStorage.totalPost;i++)(null!=localStorage["tablon"+i]&&"undefined"!=localStorage["tablon"+i]||1!=tablonActual)&&localStorage["tablon"+i]!=tablonActual||e++;break;case"2":e=localStorage.totalPost;break;case"3":e=0}e>0?chrome.action.setBadgeText({text:String(e)}):chrome.action.setBadgeText({text:""}),actualizaNombreTablon(tablonActual)}function refrescaNota(e){if(!esBackground())if(esPopup())$(".selector-varios").remove(),$(".textoNB").html(localStorage["postit"+e]);else{var t=$("#postit"+e).index();$("#postit"+e).remove(),muestraPostit(e,t),esTablonKanban()&&refrescaKanban(),refreshConnections(),hightlightCode()}}function muestraTodasLasNotas(){for(var e=localStorage.totalPost-1;e>=0;e--)muestraPostit(e);hazKanbanSortable(),refreshConnections(),hightlightCode()}function refrescaPantalla(e,t,o){if(!esBackground()&&!esPopup()){quitaZoomNotas(),e||muestraPaneles2(!1,!1),$(".sharePanel").remove(),t?$(".postitNB:not(#postitnuevo)").remove():$(".postitNB:not(#postitnuevo)").each((function(){var e=$(this).attr("data-numpost");parseInt(e)>=parseInt(localStorage.totalPost)&&$(this).remove()})),esTablonKanban()?inicializaKanban():borraKanban();for(var a=localStorage.totalPost-1;a>=0;a--)!t&&localStorage["editando"+a]&&e&&tinyMCE.get("textAreaEdit"+a)&&tinyMCE.get("textAreaEdit"+a).remove(),localStorage["editando"+a]&&!e||o&&$("#texto"+a).html()==localStorage["postit"+a]||($("#postit"+a).remove(),muestraPostit(a));esTabCompartido(tablonActual)?trataTablonComp():inicializaFriendsBot(),hazKanbanSortable(),refrescaKanban(),refrescaOrdenacion(),deslizaPostVisibles(null,!0),detectColorContrastBackground().then((()=>{refreshConnections(),$(".columna").css("borderColor",defaultColorContrastBackground)})),null==localStorage["fondo"+tablonActual]||"NaN"==localStorage["fondo"+tablonActual]||cambioTablon.sliding||cambiaFondoNum(localStorage["fondo"+tablonActual]),$(".ajaxloader").remove(),$("#Postits").imagesLoaded((function(){cambiaIcono()})),hightlightCode(),!e&&compruebaLimites(),cambiaIcono(),cambiaContador()}}function deslizaPostVisibles(e,t){var o=$(".paneles2").innerHeight()>10&&$(".paneles2").innerHeight()||$(".botones").innerHeight()||localStorage.previousHeight;o>10?localStorage.previousHeight=o:o=localStorage.previousHeight;var a=esTablonKanban()?30:0;if("down"==e)var n="+="+o+"px";else n="-="+o+"px";if(t){var i=parseInt($(".paneles2").innerHeight()+$(".titulo-kanban").height()+70+a)+"px";$("#canvasDiv").css("top",i)}else if($("#canvasDiv").animate({top:n}),esTablonKanban())$(".columna-wrapper").animate({"padding-top":n},(function(){$(".columna").height(window.innerHeight-$(".botones").height()-$(".titulo-kanban").height()-30)}));else for(var r=0;r<localStorage.totalPost;r++)(null!=localStorage["tablon"+r]&&"undefined"!=localStorage["tablon"+r]||1!=tablonActual)&&localStorage["tablon"+r]!=tablonActual||$("#postit"+r).animate({top:n});isSmallScreen()&&(compruebaCanvasPosEnMovil(500),compruebaCanvasPosEnMovil(2e3))}function muestraVotar(){if(isChromeExtension()){var e=isEdgeExtension()?"escribeReviewEdge":"escribeReview";"false"!=localStorage[e]&&sweetAlert({type:"info",text:chrome.i18n.getMessage(e),confirmText:chrome.i18n.getMessage("noMostrarMas"),cancel:!0,cancelText:chrome.i18n.getMessage("votar"),successCallback:function(){localStorage[e]="false"},cancelCallback:function(){isEdgeExtension()?window.open("https://microsoftedge.microsoft.com/addons/detail/note-board-sticky-notes/ehnmbncdeiinoaojbfjldmghkhjhlkli","_newtab"):window.open("https://chrome.google.com/webstore/detail/note-board/goficmpcgcnombioohjcgdhbaloknabb/reviews","_newtab")}})}}function pidePermiso(e,t){sweetAlert({text:chrome.i18n.getMessage(e),successCallback:function(){permisoOrigenes(t)}})}function permisoOrigenes(e){chrome.permissions.request({origins:["https://www.noteboardapp.com/"]},(function(t){t?(e&&creaFondo(),console.log("concedido")):console.log("no concedido")}))}function pidePermisoImagenes(e,t,o){"false"!=localStorage[e]&&sweetAlert({text:chrome.i18n.getMessage(e),successCallback:function(){permisoOrigenesImagenes(t,o)}})}function permisoOrigenesImagenes(e,t){chrome.permissions.request({origins:["https://www.noteboardapp.com/"]},(function(o){o?(abreFormularioAnexa(e,t),console.log("concedido")):console.log("no concedido")}))}function sendMessage(e){chrome.runtime.sendMessage(e)}function listenMessage(e,t){chrome.runtime.onMessage.addListener((function(o,a){for(var n in o)n==e&&t(o,a)}))}function formateaFecha(e){var t="",o=("0"+e.getFullYear()).slice(-2),a=("0"+parseInt(e.getMonth()+1)).slice(-2),n=("0"+e.getDate()).slice(-2);return t=idiomaEsp(navigator.language)?n+"-"+a+"-"+o:a+"-"+n+"-"+o,t+=" "+("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2)}function idiomaEsp(e){return"es"==navigator.language||"ca"==navigator.language||"es-419"==navigator.language||"es-ES"==navigator.language}function buscarText(e){var t=new Array,o=document.createElement("div"),a=0;if(0!=e.indexOf(">")&&0!=e.indexOf("<")||(a=parseInt(e.substr(1))),a)for(var n=0==e.indexOf(">"),i=0;i<localStorage.totalPost;i++)"0"!=localStorage["tablon"+i]&&(n&&difFechas(localStorage["fecha"+i])>a&&t.push(i),!n&&difFechas(localStorage["fecha"+i])<a&&t.push(i));else for(i=0;i<localStorage.totalPost;i++){o.innerHTML=localStorage["postit"+i],o.innerText.toLowerCase().indexOf(e.toLowerCase())>-1&&t.push(i)}return t}function ponAlFrente(e,t){if(-1==e.target.className.indexOf("mce_")&&-1==e.target.className.indexOf("inplace")&&"calendar"!=e.target.className){var o=maxZindex();$("#postit"+t).css("z-index",o+1)}}function ponAlFrentePost(e){var t=maxZindex();$("#postit"+e).css("z-index",t+1)}function maxZindex(e=""){var t=10;return $(".postitNB:not(#postit"+e+")").each((function(e){var o=$(this);"postitnuevo"!=o.attr("id")&&"auto"!=o.css("z-index")&&t<parseInt(o.css("z-index"))&&(t=parseInt(o.css("z-index")))})),t}function colorLuminance(e,t){(e=String(e).replace(/[^0-9a-f]/gi,"")).length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;var o,a,n="#";for(a=0;a<3;a++)o=parseInt(e.substr(2*a,2),16),n+=("00"+(o=Math.round(Math.min(Math.max(0,o+o*t),255)).toString(16))).substr(o.length);return n}function esColorOscuro(e){return"white"===getContrastYIQ(e)}function getContrastYIQ(e){return(299*parseInt(e.substr(0,2),16)+587*parseInt(e.substr(2,2),16)+114*parseInt(e.substr(4,2),16))/1e3>=65?"black":"white"}function youtube_parser(e){var t=e.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/);if(t&&11==t[7].length)return t[7];console.log("Url incorrecta")}function pausecomp(e){var t=new Date,o=null;do{o=new Date}while(o-t<e)}function validaURL(e){return/https?:\/\/(www\.)?[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi.test(e)}var imgs=new Array;function preloadImages(e){e=e||tablonActual;for(var t=0;t<localStorage.totalPost;t++)if(esNotaVisibleEnTablon(t,e)){imgs[t]=void 0;var o=document.createElement("DIV");o.innerHTML=localStorage["postit"+t];var a=o.querySelectorAll("img:not(.link-upload-img)");if(a.length>0&&(imgs[t]=new Image,imgs[t].src=a[0].src),localStorage["postit"+t]&&localStorage["postit"+t].indexOf('src="http://www.youtube.com/embed')>-1){var n=localStorage["postit"+t].indexOf('src="http://www.youtube.com')+5,i=localStorage["postit"+t].indexOf('"',n),r=localStorage["postit"+t].substring(n,i);imgs[t]=new Image,imgs[t].src="http://img.youtube.com/vi/"+youtube_parser(r)+"/0.jpg"}}}function closePaneles(e){"paneles"!=e&&($(".paneles").fadeOut(),$("#panelBotDiv").css({"box-shadow":"0 0 0px black inset"})),"searchPanel"!=e&&($(".searchPanel").fadeOut(),$("#searchBot").css({"box-shadow":"0 0 0px black inset"})),"fondos"!=e&&($(".fondos").fadeOut(),$("#cambFondo").css({"box-shadow":"0 0 0px black inset"})),"nicksComp"!=e&&($(".nicksComp").fadeOut(),$("#compBot").css({"box-shadow":"0 0 0px black inset"})),"panelFuentes"!=e&&($(".panelFuentes").fadeOut(),$("#cambF").css({"box-shadow":"0 0 0px black inset"}))}function mirarSiCerrar(e){$(".searchPanel").is(":visible")&&-1==numPostSearch&&0==$(e).closest(".searchPanel").length&&($(".searchPanel").fadeOut(),$("#searchBot").css({"box-shadow":"0 0 0px black inset"}),$(".searchResult").remove()),$(".fondos").is(":visible")&&0==$(e).closest(".fondos").length&&($(".fondos").fadeOut(),$("#cambFondo").css({"box-shadow":"0 0 0px black inset"})),$(".nicksComp").is(":visible")&&0==$(e).closest(".nicksComp").length&&($(".nicksComp").fadeOut(),$("#compBot").css({"box-shadow":"0 0 0px black inset"})),$(".panelFuentes").is(":visible")&&0==$(e).closest(".panelFuentes").length&&($(".panelFuentes").fadeOut(),$("#cambF").css({"box-shadow":"0 0 0px black inset"}))}function algunoPublico(){for(var e=1;e<=localStorage.numTablones;e++)if("true"==localStorage["publico"+e])return!0;return!1}function nombreTablon(e=tablonActual){return-999==e?chrome.i18n.getMessage("tablonWeb"):0==e?chrome.i18n.getMessage("papelera"):(null!=localStorage["tab"+e+"Label"]&&"undefined"!=localStorage["tab"+e+"Label"]&&""!=localStorage["tab"+e+"Label"]||(localStorage["tab"+e+"Label"]=chrome.i18n.getMessage("tablon")+e),localStorage["tab"+e+"Label"])}function ordenTablon(e){return null!=localStorage["ordenTablon"+e]&&"undefined"!=localStorage["ordenTablon"+e]?localStorage["ordenTablon"+e]:e}function wrapText(e,t){var o,a=new RegExp(t.replace(/[\\^$*+.?[\]{}()|]/,"\\$&"),"i"),n=[];e.normalize();for(var i=e.firstChild;null!=i;){if(i.nodeType==Node.TEXT_NODE){o="string"==typeof i.textContent?i.textContent:i.innerText;var r=a.exec(o);if(null!=r){var l=document.createDocumentFragment();r.index>0&&l.appendChild(document.createTextNode(r.input.substr(0,r.index)));var s=document.createElement("span");s.className="spanNoteBoard",s.appendChild(document.createTextNode(r[0])),l.appendChild(s),r.index+r[0].length<r.input.length&&l.appendChild(document.createTextNode(r.input.substr(r.index+r[0].length))),i.parentNode.replaceChild(l,i),i=s}}else if(i.nodeType==Node.ELEMENT_NODE&&null!=i.firstChild){n.push(i),i=i.firstChild;continue}for(;null!=i&&null==i.nextSibling;)i=n.pop();null!=i&&(i=i.nextSibling)}}function isValidDate(e){return e&&"undefined"!==e}function difFechas(e,t,o){if(!isValidDate(e)||t&&!isValidDate(t))return 0;try{if(e.indexOf("/")&&(e=e.replace(/\//g,"-")),1==e.indexOf("-")&&(e="0"+e),4==e.indexOf("-",3)&&(e=e.substr(0,3)+"0"+e.substr(3)),2==e.indexOf("-")){var a=e;e=idiomaEsp(navigator.language)?e.substr(6)+"-"+e.substr(3,2)+"-"+e.substr(0,2):e.substr(6)+"-"+e.substr(0,2)+"-"+e.substr(3,2)}o=o||"days";var n=36e5,i=24*n;e=new Date(e);var r=(t=t?new Date(t):new Date)-e;if(isNaN(r)){e=idiomaEsp(navigator.language)?a.substr(6)+"-"+a.substr(0,2)+"-"+a.substr(3,2):a.substr(6)+"-"+a.substr(3,2)+"-"+a.substr(0,2);r=t-(e=new Date(e))}if(isNaN(r))return NaN;switch(o){case"years":return t.getFullYear()-e.getFullYear();case"months":return 12*t.getFullYear()+t.getMonth()-(12*e.getFullYear()+e.getMonth());case"weeks":return Math.floor(r/6048e5);case"days":return Math.floor(r/i);case"hours":return Math.floor(r/n);case"minutes":return Math.floor(r/6e4);case"seconds":return Math.floor(r/1e3);default:return}}catch(e){return console.log(e),0}}function clickImgSelecEdit(e){$(this).parent().parent().find(".selectorPins").slideToggle();var t=$(this).parent().parent().find(".subSelectorPins");t.length>0&&t.is(":visible")&&t.slideUp()}function clickImgSelec(e,t){if(t>=0){var o=$("#postit"+t);$this=$(e.target)}else{o=$("#postitnuevo");$this=$(this)}var a=o.find(".pinImgSelec").index(e.target),n=$this.closest(".selectorPins").parent().find(".subSelectorPins");if(0==a&&o.find(".pinImg").remove(),0==a||$this.closest(".selectorPins").parent().find(".tipoPins"+a).length>0)n.slideUp((function(){$(this).remove()}));else{n.slideUp((function(){$(this).remove()}));for(var i='<div class="subSelectorPins tipoPins'+a+'" data-tipopin="'+a+'" data-postit="'+o.attr("id")+'">',r=1;r<=7;r++)i+='<img class="subPinImgSelec" src="appimg/pushpins/pushpin'+a+r+'.png">';i+="</div>",$this.closest(".selectorPins").after(i),$this.closest(".selectorPins").parent().find(".subSelectorPins").slideDown(),$(".subPinImgSelec").on("click",subClickImgSelec)}}function subClickImgSelec(e){var t=$(this).closest(".subSelectorPins").data("tipopin"),o=$(this).closest(".subSelectorPins").data("postit"),a=$("#"+o).find(".subPinImgSelec").index(e.target)+1;$("#"+o+" .pinImg").remove(),a>0&&$("#"+o).append('<img class="pinImg" data-pushpin="'+t+a+'" src="appimg/pushpins/pushpin'+t+a+'.png" />'),$(this).parent().parent().find(".pinImgSelec:first-child").attr("src","appimg/pushpins/pushpin"+t+a+".png")}function esTablonNotasWeb(e=tablonActual){return-999==e}function esTablonPapelera(e=tablonActual){return 0==e}function salSiPapelera(){return!!esTablonPapelera()&&(sweetAlert({type:"error",text:chrome.i18n.getMessage("salSiPapelera"),cancel:!1}),!0)}function inicializaPapelera(){esTablonPapelera()?($("#papelera").css({"box-shadow":"0 0 50px black inset"}),$("#botonVaciarPapelera").show()):($("#papelera").css({"box-shadow":"0 0 0px black inset"}),$("#botonVaciarPapelera").hide());for(var e=0;e<localStorage.totalPost;e++)if("0"==localStorage["tablon"+e])return void $("#papelera").find("img").attr("src","appimg/papeleraLlena.png");$("#papelera").find("img").attr("src","appimg/papelera.png"),$("#botonVaciarPapelera").hide()}function vaciarPapelera(e,t){if(t)vaciarPapeleraConfirmado(t);else{var o=chrome.i18n.getMessage("confirmarPapelera");idiomaEsp(navigator.language)&&(o="¿"+o),sweetAlert({type:"question",text:o,cancel:!0,successCallback:vaciarPapeleraConfirmado})}}function vaciarPapeleraConfirmado(e){for(var t=new Array,o=0;o<localStorage.totalPost;)"0"==localStorage["tablon"+o]&&(!e||difFechas(localStorage["fecha"+o])>e)?(isUserConnected()&&t.push(localStorage["treeId"+o]),borrarConfirmado(o,!1,!0)):o++;isUserConnected()&&t.length>0&&borraListaNotas(t)}function tirarPostitPapelera(e,t){if("nuevopost"!=e){muestraAyudaSnackbar("tiraPapelera"),$("#papelera").find("img").attr("src","appimg/papeleraLlena.png");var o=$("#postit"+e);borrarCalendar(e),o.css("z-index","998998998"),o.animate({top:"50",left:"50",zoom:"0",opacity:"0.3"},800,(function(){o.remove(),t&&t()})),sendRealTime(e,{delete:!0})}}function moverPostitTablon(e,t,o){var a=$("#postit"+e);a.css("z-index","998998998"),-999==t&&0==$("#tabPa2"+t).length&&muestraPaneles2(),esTablonCompartido(t)&&sendRealTime(e,{create:!0},t),esTablonCompartido(tablonActual)&&sendRealTime(e,{delete:!0},tablonActual),a.animate({top:$("#tabPa2"+t).offset().top,left:$("#tabPa2"+t).offset().left,opacity:"0.2"},400,(function(e){a.remove(),o&&o(),refrescaOrdenacion()}))}function notaEnPapelera(e){return"0"==localStorage["tablon"+e]}function borrarConfirmado(e,t,o){var a=localStorage["tablon"+e];for($(".sharePanel").remove(),!isUserConnected()||o||esNotaCompartida(e)||deleteNoteLogin(e),isUserConnected()||esNotaCompartida(e)||compruebaBorrarImagen(localStorage["postit"+e]),$("#postit"+e).remove(),borrarCalendar(e),borraPopupConfirmado(e),localStorage.totalPost--,i=e;i<localStorage.totalPost;i++)localStorage["postit"+i]=localStorage["postit"+(i+1)],localStorage["tipoA"+i]=localStorage["tipoA"+(i+1)],localStorage["tablon"+i]=localStorage["tablon"+(i+1)],localStorage["X"+i]=localStorage["X"+(i+1)],localStorage["Y"+i]=localStorage["Y"+(i+1)],localStorage["width"+i]=localStorage["width"+(i+1)],localStorage["height"+i]=localStorage["height"+(i+1)],localStorage["treeId"+i]=localStorage["treeId"+(i+1)],localStorage["fecha"+i]=localStorage["fecha"+(i+1)],localStorage["calendar"+i]=localStorage["calendar"+(i+1)],localStorage["sinMarco"+i]=localStorage["sinMarco"+(i+1)],null!=localStorage["updated"+(i+1)]?(localStorage["updated"+i]=localStorage["updated"+(i+1)],localStorage.removeItem("updated"+(i+1))):localStorage.removeItem("updated"+i),null!=localStorage["rotacion"+(i+1)]?(localStorage["rotacion"+i]=localStorage["rotacion"+(i+1)],localStorage.removeItem("rotacion"+(i+1))):localStorage.removeItem("rotacion"+i),null!=localStorage["pushpin"+(i+1)]?(localStorage["pushpin"+i]=localStorage["pushpin"+(i+1)],localStorage.removeItem("pushpin"+(i+1))):localStorage.removeItem("pushpin"+i),null!=localStorage["notaWeb"+(i+1)]?(localStorage["notaWeb"+i]=localStorage["notaWeb"+(i+1)],localStorage.removeItem("notaWeb"+(i+1))):localStorage.removeItem("notaWeb"+i),null!=localStorage["userComp"+(i+1)]?(localStorage["userComp"+i]=localStorage["userComp"+(i+1)],localStorage["nickComp"+i]=localStorage["nickComp"+(i+1)],localStorage.removeItem("userComp"+(i+1)),localStorage.removeItem("nickComp"+(i+1))):(localStorage.removeItem("userComp"+i),localStorage.removeItem("nickComp"+i)),null!=localStorage["errorConexion"+(i+1)]?(localStorage["errorConexion"+i]=localStorage["errorConexion"+(i+1)],localStorage.removeItem("errorConexion"+(i+1))):localStorage.removeItem("errorConexion"+i),null!=localStorage["columnaKanban"+(i+1)]?(localStorage["columnaKanban"+i]=localStorage["columnaKanban"+(i+1)],localStorage.removeItem("columnaKanban"+(i+1))):localStorage.removeItem("columnaKanban"+i),null!=localStorage["connections"+(i+1)]?(localStorage["connections"+i]=localStorage["connections"+(i+1)],localStorage.removeItem("connections"+(i+1))):localStorage.removeItem("connections"+i),null!=localStorage["minimizado"+(i+1)]?(localStorage["minimizado"+i]=localStorage["minimizado"+(i+1)],localStorage.removeItem("minimizado"+(i+1))):localStorage.removeItem("minimizado"+i),null!=imgs[i+1]?imgs[i]=imgs[i+1]:imgs[i]=void 0;updateConnectionsBorrado(e),refrescaPantalla(!1,!0),localStorage.removeItem("postit"+localStorage.totalPost),localStorage.removeItem("tablon"+localStorage.totalPost),localStorage.removeItem("tipoA"+localStorage.totalPost),localStorage.removeItem("X"+localStorage.totalPost),localStorage.removeItem("Y"+localStorage.totalPost),localStorage.removeItem("width"+localStorage.totalPost),localStorage.removeItem("height"+localStorage.totalPost),localStorage.removeItem("treeId"+localStorage.totalPost),localStorage.removeItem("fecha"+localStorage.totalPost),localStorage.removeItem("updated"+localStorage.totalPost),localStorage.removeItem("calendar"+localStorage.totalPost),localStorage.removeItem("sinMarco"+localStorage.totalPost),localStorage.removeItem("userComp"+localStorage.totalPost),localStorage.removeItem("nickComp"+localStorage.totalPost),localStorage.removeItem("errorConexion"+localStorage.totalPost),localStorage.removeItem("rotacion"+localStorage.totalPost),localStorage.removeItem("pushpin"+localStorage.totalPost),localStorage.removeItem("notaWeb"+localStorage.totalPost),localStorage.removeItem("columnaKanban"+localStorage.totalPost),localStorage.removeItem("connections"+localStorage.totalPost),imgs[localStorage.totalPost]=void 0,"0"!=a||esBackground()||inicializaPapelera(),"function"==typeof aplicaMasonry&&(preloadImages(),aplicaMasonry()),cambiaIcono(),cambiaContador()}function compruebaBorrarImagen(e){if(e){var t=e.indexOf("https://www.noteboardapp.com/users/");t>-1&&borrarImagen(e.substring(t,e.indexOf(".",t+30)+4)),(t=e.indexOf("https://noteboardapp.s3.amazonaws.com/users/"))>-1&&borrarFicherosAws(e,!0)}}function esNotaWeb(e){return null!=localStorage["notaWeb"+e]}function notaPerteneceUrl(e,t){if(!localStorage["notaWeb"+e])return!1;var o=localStorage["notaWeb"+e].split("||");return o[0].endsWith("/*")?getHostFromUrl(o[0]).replace(/(^\w+:|^)\/\//,"")==getHostFromUrl(t).replace(/(^\w+:|^)\/\//,""):o[0].replace(/(^\w+:|^)\/\//,"")==t.replace(/(^\w+:|^)\/\//,"")}function urlDeNotaWeb(e){return localStorage["notaWeb"+e]?localStorage["notaWeb"+e].split("||")[0]:""}function algunaNotaWeb(){for(var e=0;e<localStorage.totalPost;e++)if("-999"==localStorage["tablon"+e])return!0;return!1}function getPosicionNotaWeb(e){if(localStorage["notaWeb"+e]){var t=localStorage["notaWeb"+e].split("||");return{x:t[1],y:t[2]}}}function setPosicionNotaWeb(e,t,o){if(localStorage["notaWeb"+e]){var a=localStorage["notaWeb"+e].split("||");a[1]=t,a[2]=o,localStorage["notaWeb"+e]=a.join("||")}}function setUrlNotaWeb(e,t){if(localStorage["notaWeb"+e]){var o=localStorage["notaWeb"+e].split("||");o[0]=t,localStorage["notaWeb"+e]=o.join("||")}}async function modificaNotaWeb(e){var t=e.numPost;e.width&&(localStorage["width"+t]=e.width),e.height&&!tieneNotaAlturaAuto(t)&&(localStorage["height"+t]=e.height),e.left&&setPosicionNotaWeb(t,e.left,e.top),e.url&&setUrlNotaWeb(t,e.url),isUserConnected()&&updateNotaLogin(t),await setAllLocalStorage(),sendMessage({mensBack:"muestraNotas"})}async function borraNotaWeb(e){var t=e.numPost;localStorage["tablon"+t]=0;var o=new Date;idiomaEsp(navigator.language)?localStorage["fecha"+t]=o.getDate()+"/"+(o.getMonth()+1)+"/"+o.getFullYear():localStorage["fecha"+t]=o.getMonth()+1+"/"+o.getDate()+"/"+o.getFullYear(),isUserConnected()&&updateNotaLogin(t),await setAllLocalStorage(),sendMessage({mensBack:"muestraNotas"})}async function adjuntaHtmlWeb(e){var t=e.numPost,o=e.html;localStorage["postit"+t]+="<br>"+compruebaVideos(o),"auto"==localStorage["width"+t]&&(localStorage["width"+t]=$("#postit"+t).width()),$("#postit"+t).remove(),isUserConnected()&&updateNotaLogin(t),getCalendarMail(t)&&crearRegistroMail(t),await setAllLocalStorage(),sendMessage({mensBack:"muestraNotas"})}function cierraVentana(){setTimeout((function(){window.close()}),3e3)}function puntoEnPostit(e,t,o){var a=$("#postit"+e);if(!a.is(":visible"))return!1;var n=parseInt(localStorage["X"+e]),i=parseInt(localStorage["Y"+e]),r=a.width(),l=a.height();return n<=t&&t<=n+r&&i<=o&&o<=i+l}function webkitBrowser(){return navigator.userAgent.toLowerCase().indexOf("webkit")>-1}function elementoEncima(e,t){var o=e.height()||30,a=e.offset().top,n=e.offset().left,i=a+o,r=n+e.width(),l=t.offset().top,s=t.offset().left,c=l+t.height(),d=s+t.width();return!(i<l||a>c||r<s||n>d)}function inicializaTema(e){(e||"default"==localStorage.seleccionTema)&&$("body").removeClass("metal piedra marmol lava colorNegro colorGris colorBlanco colorAzul colorVerde"),localStorage.seleccionTema&&("colorGris"!=localStorage.seleccionTema||e)&&"default"!=localStorage.seleccionTema&&($("body").addClass(localStorage.seleccionTema),$(".paneles2").css({"background-position":"right top"}),"colorBlanco"==localStorage.seleccionTema&&$(".boardsSwitch").css("filter","invert(1)"))}function ponTooltipPaneles2(){$(".tabPaneles2").each((function(){var e=$(this).attr("id").substr(6);"+"!=e&&$(this).tooltipster({content:'<div class="contenedor-tablon-tooltip"><div class="borrar-tablon-tooltip" id="borraTabToo'+e+'"><img src="appimg/removeWhite.png"></div><canvas id="canvasTooltip'+e+'" class="canvas-tooltip" width="125" height="100"></canvas></div>',contentCloning:!1,contentAsHTML:!0,theme:["tooltipster-noir","tooltipster-noir-customized"],side:"bottom",delay:100,functionReady:function(){dibujaMaqueta("canvasTooltip"+e,e,125,100),$("#canvasTooltip"+e).off().on("click",(function(){clickTablon(null,!1,e)})),$("#borraTabToo"+e).off().on("click",(function(){borraTablon(e)})),$(".borrar-tablon-tooltip").attr("title",chrome.i18n.getMessage("borraTablon"))},interactive:!0})}))}function compruebaNotasWeb(){if(!isChromeExtension())return!1;for(var e=!1,t=0;t<localStorage.totalPost;t++)if(esNotaWeb(t)){e=!0;break}e&&(document.URL.indexOf("popup.html")>0||document.URL.indexOf("options.html")>0?chrome.permissions.contains({permissions:["tabs"],origins:["http://*/*","https://*/*"]},(function(e){e||sweetAlert({text:chrome.i18n.getMessage("notasWebPermisos"),successCallback:function(){chrome.permissions.request({permissions:["tabs"],origins:["http://*/*","https://*/*"]},(function(e){e&&console.log("aceptado")}))},cancel:!1,type:"warning"})})):sendMessage({mensBack:"compruebaNotasWeb"}))}function checkOverflow(e){var t=e.style.overflow;t&&"visible"!==t||(e.style.overflow="hidden");var o=e.clientWidth<e.scrollWidth||e.clientHeight<e.scrollHeight;return e.style.overflow=t,o}function postitNoVisibleEntero(e){return checkOverflow(document.getElementById("texto"+e))}function compruebaPostitDebajoDeOtros(){"true"==localStorage["masonry"+tablonActual]&&0===$(".pinnedNB").length||$(".postitNB").each((function(){var e=parseInt($(this).attr("id").substr(6));x=parseInt(localStorage["X"+e]),y=parseInt(localStorage["Y"+e]),widthPost=$("#postit"+e).width(),heightPost=$("#postit"+e).height(),$(".postitNB").each((function(){var t=parseInt($(this).attr("id").substr(6));if(t!=e&&puntoEnPostit(t,x,y)&&puntoEnPostit(t,x+widthPost,y)&&puntoEnPostit(t,x,y+heightPost)&&puntoEnPostit(t,x+widthPost,y+heightPost)){var o=maxZindex();$("#postit"+e).css("z-index",o+1)}}))}))}function limpiaNombreTablon(e){return e.replace(/\\/g,"").replace(/\"/g,"")}function clearSelection(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){window.getSelection().removeAllRanges()}}function creaTablonTemporal(){$("#postits-temp").remove(),cambioTablon.sliding=!0;var e=$("#Postits"),t=$(".tablonPostits");cambioTablon.haciaDerecha?e.after('<div class="Postits" id="Postits" ></div>'):e.before('<div class="Postits" id="Postits" ></div>'),e.removeAttr("id").addClass("postits-temp").attr("id","postits-temp").removeClass("Postits"),cambioTablon.haciaDerecha?(e.css("overflow","auto"),e.width(window.innerWidth)):($("#Postits").css("overflow","auto"),e.width(window.innerWidth)),$("#Postits").width(window.innerWidth),t.width(t.width()+window.innerWidth),t.width(t.width()+window.innerWidth+100),$(".postitNB",e).removeAttr("id").removeClass("postitNB"),cambioTablon.haciaDerecha||$(window).scrollLeft(window.innerWidth)}function borraTablonTemporal(e){var t=cambioTablon.haciaDerecha?window.innerWidth:0;esTablonOrdenado()&&ajustaNotasYPadding(),$("html").animate({scrollLeft:t,scrollTop:0},800,(function(){$("#postits-temp").remove(),$(".tablonPostits").width($("#Postits").width()),$("#Postits").css("overflow","visible").width(window.innerWidth),detectColorContrastBackground().then((()=>{refreshConnections(),$(".columna").css("borderColor",defaultColorContrastBackground)})),cambioTablon.sliding=!1,compruebaLimites(),window.scrollTo(0,0),cambiaIcono(!0),compruebaCanvasPosEnMovil(100),$("#Postits").css("background-image",""),cambiaFondoNum(localStorage["fondo"+e])}))}function elementInViewport(e){for(var t=e.offsetTop,o=e.offsetLeft,a=e.offsetWidth,n=e.offsetHeight;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,o+=e.offsetLeft;return t>=window.pageYOffset&&o>=window.pageXOffset&&t+n<=window.pageYOffset+window.innerHeight&&o+a<=window.pageXOffset+window.innerWidth}function compruebaMinimapa(){hideMinimapa?($("#canvasMaqueta").hide(),$("#maquetaPant").hide()):($("#canvasMaqueta").show(),$("#maquetaPant").show())}function actualizaNombreTablon(e){document.getElementById("nombreTablon")&&(e=e||tablonActual||localStorage.tablonActual,document.getElementById("nombreTablon").innerText=`${nombreTablon(e)} - ${cuentaNotas(e)}`)}function cuentaNotas(e){for(var t=0,o=0;o<localStorage.totalPost;o++)esNotaVisibleEnTablon(o,e)&&t++;return t}function checkMaxLocalStorage(){try{return localStorage.pruebaMaximoAlcanzado="test".repeat(100),localStorage.removeItem("pruebaMaximoAlcanzado"),!0}catch(e){return!1}}function getLocalStorageSize(){return JSON.stringify(localStorage).length}function guardaTextoEnNota(e,t){try{localStorage["postit"+e]=t}catch(e){getLocalStorageSize()+t.length>524e4&&sweetAlert({type:"error",text:chrome.i18n.getMessage("noMasEspacio")}),console.log(e)}}function detectColorBackground(e){var t=document.createElement("img"),o=document.getElementById("Postits"),a=o.currentStyle||window.getComputedStyle(o,!1);a.backgroundImage.indexOf("://")>-1&&-1==a.backgroundImage.indexOf("noise")?(t.src=a.backgroundImage.slice(4,-1).replace(/"/g,""),t.onload=function(){$.adaptiveBackground.run({selector:t,success:function(t,o){e(colourBrightness(o.color))}})}):e(colourBrightness(a.backgroundColor))}function colourBrightness(e){var t=e.substring(4,e.length-1).replace(/ /g,"").split(",");return Math.round((299*parseInt(t[0])+587*parseInt(t[1])+114*parseInt(t[2]))/1e3)>125?"#333":"white"}jQuery.fn.sortElements=function(){var e=[].sort;return function(t,o){o=o||function(){return this};var a=this.map((function(){var e=o.call(this),t=e.parentNode,a=t.insertBefore(document.createTextNode(""),e.nextSibling);return function(){if(t===this)throw new Error("You can't sort elements if any one is a descendant of another.");t.insertBefore(this,a),t.removeChild(a)}}));return e.call(this,t).each((function(e){a[e].call(o.call(this))}))}}();var defaultColorContrastBackground="#333";function detectColorContrastBackground(){let e;return e=new Promise(((e,t)=>{detectColorBackground((t=>{e(defaultColorContrastBackground=t)}))})),e}function getRandomNumber(e,t){return Math.floor(Math.random()*(t+1-e))+e}function iniLocalStorageCaptureData(){localStorage.removeItem("imageSave"),localStorage.removeItem("capturaPantalla"),localStorage.removeItem("capturaVideo")}function isUserConnected(){return"true"==localStorage.sincroLogin}function resizeWindow(e,t,o){isChromeExtension()?chrome.runtime.sendMessage({resizeWindow:{winId:e,width:t,height:o}}):window.resizeTo(t,o)}function getRandomNoteType(){return TIPOS_NOTAS_RANDOM[getRandomNumber(0,TIPOS_NOTAS_RANDOM.length-1)]}function esBackground(){return document.URL.indexOf("background")>0}function traduceLiteralesHtml(){document.querySelectorAll("[data-locale]").forEach((e=>{e.innerText=chrome.i18n.getMessage(e.dataset.locale)}))}function tieneNotaAlturaAuto(e){return"auto"==localStorage["height"+e]}function getAlturaNota(e){return tieneNotaAlturaAuto(e)?$("#postit"+e)?.height()||(()=>{const t=localStorage["postit"+e].length/2;return 300>t?300:t})():parseInt(localStorage["height"+e])}function restaurarMedidasAutoNota(e){$("#postit"+e).height("auto"),$("#texto"+e).css("maxHeight","calc(95vh - 90px)")}function getBoardNumberParam(){return new URL(window.location.href).searchParams.get("boardNumber")}function setNewTab(e,t){localStorage["new-tab"]=JSON.stringify({numTab:e,hideBar:t})}function getNewTab(){let e=!1;if(localStorage["new-tab"])try{e=JSON.parse(localStorage["new-tab"])}catch(e){console.log(e)}return e}function getGridData(){var e=!1;if(localStorage["grid-drag"])try{e={x:localStorage["grid-drag"].split("x")[0],y:localStorage["grid-drag"].split("x")[1]}}catch(e){console.log(e)}return e}function addNopubli(){$noPubli=$("#cansadoAnun"),$noPubli.length&&($noPubli.html(chrome.i18n.getMessage("quitaAnuncios")),$noPubli.on("click",(()=>muestraMensajeHaztePremium())))}function isWebNotesBoard(e=tablonActual){return-999==e}function isFunction(e){return!(!e||"function"!=typeof e)}function addScalable(){isMobile()&&document.querySelector("meta[name=viewport]").setAttribute("content","width=device-width, initial-scale=1, user-scalable=yes")}function removeScalable(){isMobile()&&document.querySelector("meta[name=viewport]").setAttribute("content","width=device-width, initial-scale=1, user-scalable=no")}function getHashUrl(e){return e.substr(e.indexOf("#")+1)}function getLocaleDate(e){if(!e)return;const t=e.split("-");return new Date(t[1]+"/"+t[0]+"/"+t[2]).toLocaleDateString(navigator.language,{year:"numeric",month:"long",day:"numeric"})}function topBarHasBoards(){return localStorage.showTabs===TOP_BAR.BOARDS}function isServiceWorker(){return"ServiceWorkerGlobalScope"in self&&self instanceof ServiceWorkerGlobalScope}var posCompartidas=new Array;function inicializaLocalStorage(){for(var e=1;e<=localStorage.numTablones;e++)localStorage.removeItem("tab"+e+"Label"),localStorage.removeItem("publico"+e),localStorage.removeItem("ordenTablon"+e),localStorage.removeItem("masonry"+e),localStorage.removeItem("tablonKanban"+e);var t=0;localStorage.removeItem("treeId10000");for(e=0;e<localStorage.totalPost;e++)esNotaCompartida(e)&&guardaPosCompartido(e),null==localStorage["errorConexion"+e]&&null!=localStorage["treeId"+e]||null==localStorage["postit"+e]||(null==localStorage["treeId"+e]&&(localStorage["errorConexion"+e]="create"),e>t&&(muevePostit(e,t),localStorage.removeItem("errorConexion"+e)),t++,clearInterval(intervalErrorConexion),intervalErrorConexion=setInterval(intentaConexion,1e4)),null!=localStorage["errorConexion"+e]&&e==t-1||(localStorage.removeItem("postit"+e),localStorage.removeItem("tablon"+e),localStorage.removeItem("tipoA"+e),localStorage.removeItem("X"+e),localStorage.removeItem("Y"+e),localStorage.removeItem("width"+e),localStorage.removeItem("height"+e),localStorage.removeItem("treeId"+e),localStorage.removeItem("fecha"+e),localStorage.removeItem("updated"+e),localStorage.removeItem("calendar"+e),localStorage.removeItem("sinMarco"+e),localStorage.removeItem("userComp"+e),localStorage.removeItem("nickComp"+e),localStorage.removeItem("rotacion"+e),localStorage.removeItem("pushpin"+e),localStorage.removeItem("notaWeb"+e),localStorage.removeItem("columnaKanban"+e),localStorage.removeItem("connections"+e),localStorage.removeItem("minimizado"+e));localStorage.totalPost=t}function muevePostit(e,t){localStorage["postit"+t]=localStorage["postit"+e],localStorage["tipoA"+t]=localStorage["tipoA"+e],localStorage["tablon"+t]=localStorage["tablon"+e],localStorage["X"+t]=localStorage["X"+e],localStorage["Y"+t]=localStorage["Y"+e],localStorage["width"+t]=localStorage["width"+e],localStorage["height"+t]=localStorage["height"+e],localStorage["treeId"+t]=localStorage["treeId"+e],localStorage["fecha"+t]=localStorage["fecha"+e],localStorage["updated"+t]=localStorage["updated"+e],localStorage["calendar"+t]=localStorage["calendar"+e],localStorage["sinMarco"+t]=localStorage["sinMarco"+e],null!=localStorage["userComp"+e]?(localStorage["userComp"+t]=localStorage["userComp"+e],localStorage["nickComp"+t]=localStorage["nickComp"+e]):(localStorage.removeItem("userComp"+t),localStorage.removeItem("nickComp"+t)),null!=localStorage["errorConexion"+e]?localStorage["errorConexion"+t]=localStorage["errorConexion"+e]:localStorage.removeItem("errorConexion"+t),null!=localStorage["rotacion"+e]?localStorage["rotacion"+t]=localStorage["rotacion"+e]:localStorage.removeItem("rotacion"+t),null!=localStorage["pushpin"+e]?localStorage["pushpin"+t]=localStorage["pushpin"+e]:localStorage.removeItem("pushpin"+t),null!=localStorage["notaWeb"+e]?localStorage["notaWeb"+t]=localStorage["notaWeb"+e]:localStorage.removeItem("notaWeb"+t),null!=localStorage["columnaKanban"+e]?localStorage["columnaKanban"+t]=localStorage["columnaKanban"+e]:localStorage.removeItem("columnaKanban"+t),null!=localStorage["connections"+e]?localStorage["connections"+t]=localStorage["connections"+e]:localStorage.removeItem("connections"+t),null!=localStorage["minimizado"+e]?localStorage["minimizado"+t]=localStorage["minimizado"+e]:localStorage.removeItem("minimizado"+t)}function obtenerNickPublico(){var e=getServerUrl()+"api/obtenNickPublico.php";e+="?id_usuario="+localStorage.id_usuario,$.ajax({type:"GET",url:e,cache:!1,success:function(e){var t=JSON.parse(e);t.isSuccess&&(localStorage.nickPublico=t.nickPublico)},error:function(e,t,o){console.log(t)}})}function logoutUsuario(){localStorage.removeItem("id_usuario"),localStorage.removeItem("token"),localStorage.removeItem("sincroLogin"),localStorage.removeItem("nick"),localStorage.removeItem("confirmado"),localStorage.removeItem("fbToken"),localStorage.removeItem("fbId"),localStorage.removeItem("googleId"),localStorage.sincroLogin=!1,document.getElementById("logoutForm").style.display="none",document.getElementById("loginForm").style.display="block"}function grabaNotaLogin(e){if(!isDemoUser(e)){if(e<1e4){"undefined"!=localStorage["tablon"+e]&&null!=localStorage["tablon"+e]||(localStorage["tablon"+e]=1),null!=localStorage["sinMarco"+e]&&"undefined"!=localStorage["sinMarco"+e]||(localStorage["sinMarco"+e]="false");var t={tipoA:localStorage["tipoA"+e],X:localStorage["X"+e],Y:localStorage["Y"+e],postit:localStorage["postit"+e],width:localStorage["width"+e],height:localStorage["height"+e],fecha:localStorage["fecha"+e],tablon:localStorage["tablon"+e],calendar:localStorage["calendar"+e],sinMarco:localStorage["sinMarco"+e],rotacion:localStorage["rotacion"+e],pushpin:localStorage["pushpin"+e],notaWeb:localStorage["notaWeb"+e],columnaKanban:localStorage["columnaKanban"+e],connections:localStorage["connections"+e],minimizado:localStorage["minimizado"+e]}}else{for(var o=new Array,a=new Array,n=new Array,i=new Array,r=new Array,l=new Array,s=1;s<=localStorage.numTablones;s++)null==localStorage["tab"+s+"Label"]&&(localStorage["tab"+s+"Label"]="undefined"),o.push(localStorage["tab"+s+"Label"]),a.push(localStorage["fondo"+s]),"true"==localStorage["publico"+s]?n.push(1):n.push(0),"true"==localStorage["masonry"+s]?r.push(1):r.push(0),i.push(ordenTablon(s)),localStorage["tablonKanban"+s]?l.push(localStorage["tablonKanban"+s]):l.push("");var c={tabLabels:o,tabBgs:a,tabPublico:n,tabOrden:i,tabMasonry:r,fuente:localStorage.fuente,size:localStorage.size,tabKanban:l};t={tipoA:TIPO_NOTA.TABLONES,X:0,Y:0,postit:JSON.stringify(c),width:0,height:0,rotacion:"",fecha:"",tablon:0,calendar:"",sinMarco:!1,pushpin:"",notaWeb:""}}var d="id_usuario="+localStorage.id_usuario;d+="&token="+localStorage.token,d+="&nota="+encodeURIComponent(JSON.stringify(t)),d+="&sid="+localStorage.sid,$.ajax({type:"POST",url:getServerUrl()+"api/createNote.php",data:d,cache:!1,success:function(o){var a=JSON.parse(o);a.isSuccess?(null!=localStorage["errorConexion"+e]&&(localStorage.removeItem("errorConexion"+e),e<1e4&&(localStorage.refrescaNota=e,sendMessage({mensBack:"refrescaNota"}))),localStorage["treeId"+e]=a.idNota,sendRealTime(e,{create:!0},localStorage["tablon"+e]),$("#postit"+e).length>0&&$("#postit"+e).attr("data-treeid",a.idNota),a.espacio&&(localStorage.espacio=a.espacio),1e4!=e||!registrando&&"true"!=localStorage.nuevoReg||(localStorage.removeItem("nuevoReg"),registrando=!1,chrome.tabs.create({url:GO_PREMIUM_URL+"?sessionId="+localStorage.sessionId}),modalInstance.close()),e<1e4&&localStorage["postit"+e].indexOf("data:image/")>0&&null!=a.postit&&(localStorage["postit"+e]=a.postit.replace(/<\/p>n<p>/gm,"</p>\n<p>"),refrescaNota(e))):(console.log("OK "+a.error),sendReportError(localStorage.id_usuario,e,encodeURIComponent(JSON.stringify(t))))},error:function(t,o,a){404===t.status?manageConnectionError(e,"create"):localStorage.removeItem("errorConexion"+e)}})}}function manageConnectionError(e,t,o=!0){esBackground()?errorConexion(e,t):(sendMessage({menstoBack:"errorConexion",numPost:e,operacion:t}),o&&muestraAyuda("mensErrorConexion"))}function updateNotaMemo(e){isUserConnected()&&updateNotaLoginMemo(e)}function updateNotaLoginMemo(e){e<1e4?(localStorage["updated"+e]="true",sendRealTime(e,localStorage["tablon"+e])):updateNotaLogin(e)}function updateNotaLogin(e){if(!isDemoUser(e)&&isUserConnected()){if("undefined"!=localStorage["tablon"+e]&&null!=localStorage["tablon"+e]||(localStorage["tablon"+e]=1),e<1e4){null!=localStorage["sinMarco"+e]&&"undefined"!=localStorage["sinMarco"+e]||(localStorage["sinMarco"+e]="false");var t={tipoA:localStorage["tipoA"+e],X:localStorage["X"+e],Y:localStorage["Y"+e],postit:localStorage["postit"+e],width:localStorage["width"+e],height:localStorage["height"+e],fecha:localStorage["fecha"+e],tablon:localStorage["tablon"+e],calendar:localStorage["calendar"+e],sinMarco:localStorage["sinMarco"+e],rotacion:localStorage["rotacion"+e],pushpin:localStorage["pushpin"+e],notaWeb:localStorage["notaWeb"+e],columnaKanban:localStorage["columnaKanban"+e],connections:localStorage["connections"+e],minimizado:localStorage["minimizado"+e]};sendRealTime(e,localStorage["tablon"+e])}else{for(var o=new Array,a=new Array,n=new Array,i=new Array,r=new Array,l=new Array,s=1;s<=localStorage.numTablones;s++)null==localStorage["tab"+s+"Label"]&&(localStorage["tab"+s+"Label"]="undefined"),o.push(localStorage["tab"+s+"Label"]),a.push(localStorage["fondo"+s]),"true"==localStorage["publico"+s]?n.push(1):n.push(0),"true"==localStorage["masonry"+s]?r.push(1):r.push(0),i.push(ordenTablon(s)),localStorage["tablonKanban"+s]?l.push(localStorage["tablonKanban"+s]):l.push("");var c={tabLabels:o,tabBgs:a,tabPublico:n,tabOrden:i,tabMasonry:r,fuente:localStorage.fuente,size:localStorage.size,tabKanban:l};t={tipoA:TIPO_NOTA.TABLONES,X:0,Y:0,postit:JSON.stringify(c),width:0,height:0,fecha:"",tablon:0,calendar:"",pushpin:"",sinMarco:!1}}if(localStorage["updated"+e]="false",null==localStorage["userComp"+e]||"R"==localStorage["userComp"+e])var d=localStorage.id_usuario,u="false";else d=localStorage["userComp"+e],u="true";var g="id_usuario="+d;g+="&token="+localStorage.token,g+="&id_nota="+localStorage["treeId"+e],g+="&nota="+encodeURIComponent(JSON.stringify(t)),g+="&sid="+localStorage.sid,g+="&compartido="+u,$.ajax({type:"POST",url:getServerUrl()+"api/updateNote.php",data:g,cache:!1,success:function(o){var a=JSON.parse(o);a.isSuccess?(a.espacio&&(localStorage.espacio=a.espacio),null!=localStorage["errorConexion"+e]&&(localStorage.removeItem("errorConexion"+e),e<1e4&&(localStorage.refrescaNota=e,sendMessage({mensBack:"refrescaNota"}))),e<1e4&&localStorage["postit"+e].indexOf("data:image/")>0&&null!=a.postit&&(localStorage["postit"+e]=a.postit.replace(/<\/p>n<p>/gm,"</p>\n<p>"),refrescaNota(e))):(console.log("OK "+a.error),sendReportError(localStorage.id_usuario,e,encodeURIComponent(JSON.stringify(t))))},error:function(t,o,a){404===t.status?manageConnectionError(e,"update"):localStorage.removeItem("errorConexion"+e)}})}}function deleteNoteLogin(e){if(!isDemoUser()){var t="id_usuario="+localStorage.id_usuario;t+="&token="+localStorage.token,t+="&id_nota="+localStorage["treeId"+e],t+="&sid="+localStorage.sid,$.ajax({type:"POST",url:getServerUrl()+"api/deleteNote.php",data:t,cache:!1,success:function(e){var t=JSON.parse(e);t.isSuccess?t.espacio&&(localStorage.espacio=t.espacio):console.log("OK "+t.error)},error:function(e,t,o){console.log(t)}})}}function borraListaNotas(e){if(!isDemoUser()){var t="id_usuario="+localStorage.id_usuario;t+="&token="+localStorage.token,t+="&listaNotas="+encodeURIComponent(JSON.stringify(e)),t+="&sid="+localStorage.sid,$.ajax({type:"POST",url:getServerUrl()+"api/deleteListNotes.php",data:t,cache:!1,success:function(e){var t=JSON.parse(e);t.isSuccess?t.espacio&&(localStorage.espacio=t.espacio):console.log("OK "+t.error)},error:function(e,t,o){console.log(t)}})}}function borrarImagen(e){var t="imgUrl="+encodeURIComponent(e);$.ajax({type:"POST",url:getServerUrl()+"api/deleteImage.php",data:t,cache:!1,success:function(e){if(!isUserConnected())try{restaEspacioServidor(JSON.parse(e).spaceFiles)}catch(e){console.log(e)}},error:function(e,t,o){console.log(t)}})}function borrarFicherosAws(e,t){if(e&&-1!=e.indexOf("noteboardapp")){var o="ficheros="+encodeURIComponent(e);$.ajax({type:"POST",url:getServerUrl()+"api/borraFichAws.php",data:o,cache:!1,success:function(e){if(t&&!isUserConnected())try{restaEspacioServidor(JSON.parse(e).spaceFiles)}catch(e){console.log(e)}}})}}let getNotesTry=0;async function sincronizaLogin(e,t,o){esBackground()&&!localStorage.id_usuario&&await getLocalStorage();var a=getServerUrl()+"api/getNotes2.php";const n=new URLSearchParams;n.append("id_usuario",localStorage.id_usuario),n.append("token",localStorage.token);try{n.append("stackTrace",(new Error).stack),n.append("getNotesTry",getNotesTry)}catch(e){console.log(e)}fetch(a,{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n}).then((a=>{if(!a.ok)throw getNotesTry<3&&(getNotesTry++,setTimeout((function(){sincronizaLogin(e,t,o)}),1e4*getNotesTry)),new Error("Network response was not ok");return a.json()})).then((async function(a){getNotesTry=0;var n=a;n.isSuccess&&(localStorage.sid=n.sid,localStorage.confirmado=n.confirmado,localStorage.publicCount=n.publicCount,null!=n.invitaciones?recibeInvitaciones(n.invitaciones):localStorage.removeItem("invitaciones"),null!=n.invEnviadas?recibeInvEnviadas(n.invEnviadas):localStorage.removeItem("invEnviadas"),e?t&&"function"==typeof muestraPostit?cargaNotasAdd(n,t,o):(cargaNotasAdd(n,!1,o),esBackground()&&await setAllLocalStorage(),sendMessage({mensBack:"muestraNotas"})):(inicializaLocalStorage(),cargaNotas(n,t,o),esBackground()&&await setAllLocalStorage(),sendMessage({mensBack:"muestraNotas"})),null!=n.comparticiones?recibeComparticiones(n.comparticiones):localStorage.removeItem("comparticiones"),vaciarPapelera({},30),compruebaPopups(),muestraPops(),!esBackground()&&($(".updateButton").is(":visible")||$("#progress").is(":visible")||$("#black_overlay-web-app").is(":visible"))&&(refrescaPantalla(!1,!0),refrescaOrdenacion(),$(".updateButton").find(".ajaxloader").remove()),esBackground()?(chrome.contextMenus.removeAll(initializeMenus),miraAgenda(),await setAllLocalStorage()):(sendMessage({menstoBack:"cambioMenu"}),muestraPaneles2(!1,!0),$("#black_overlay-web-app").fadeOut(400)),compruebaNotasWeb())})).catch((e=>{console.error("Error:",e)}))}function cargaNotas(e,t,o){var a=0;e.mail&&(localStorage.mail=e.mail),e.espacio&&(localStorage.espacio=e.espacio),e.premium&&(localStorage.premium=e.premium);let n=0;for(;e[n];){if(null!=e[n].postit)if(e[n].tipoA!=TIPO_NOTA.TABLONES){var i=localStorage.totalPost;localStorage["tipoA"+i]=e[n].tipoA,localStorage["X"+i]=e[n].X,localStorage["Y"+i]=e[n].Y,localStorage["postit"+i]=e[n].postit,localStorage["width"+i]=e[n].width,localStorage["height"+i]="0"==e[n].height?"auto":e[n].height,localStorage["fecha"+i]=e[n].fecha,localStorage["treeId"+i]=e[n].id_nota,localStorage["tablon"+i]=e[n].tablon,localStorage["calendar"+i]=e[n].calendar,localStorage["sinMarco"+i]="1"==e[n].sinMarco,e[n].rotacion&&(localStorage["rotacion"+i]=e[n].rotacion),e[n].pushpin&&(localStorage["pushpin"+i]=e[n].pushpin),e[n].notaWeb&&(localStorage["notaWeb"+i]=e[n].notaWeb),e[n].columnaKanban&&(localStorage["columnaKanban"+i]=e[n].columnaKanban),e[n].connections&&(localStorage["connections"+i]=e[n].connections),e[n].minimizado&&"0"!=e[n].minimizado&&(localStorage["minimizado"+i]="1"==e[n].minimizado),parseInt(e[n].tablon)>a&&"-999"!=e[n].tablon&&(a=parseInt(e[n].tablon)),null!=e[n].permisos&&("RW"==e[n].permisos?localStorage["userComp"+i]=e[n].userComp:localStorage["userComp"+i]="R",localStorage["nickComp"+i]=e[n].nickComp,recuperaPosCompartido(i)),localStorage.totalPost++}else{localStorage.treeId10000=e[n].id_nota;try{var r=JSON.parse(e[n].postit)}catch(t){try{r=JSON.parse(e[n].postit.replace("\\",""))}catch(e){console.log(e);r={tabLabels:[]}}}var l=r.tabLabels.length,s=localStorage.numTablones;if(null==localStorage.errorConexion10000||l>s){for(var c=1;c<=l;c++)localStorage["tab"+c+"Label"]=r.tabLabels[c-1],localStorage["fondo"+c]=r.tabBgs[c-1],null!=r.tabPublico&&1==r.tabPublico[c-1]?localStorage["publico"+c]="true":localStorage["publico"+c]="false",null!=r.tabMasonry&&1==r.tabMasonry[c-1]?localStorage["masonry"+c]="true":localStorage["masonry"+c]="false",null!=r.tabOrden&&(localStorage["ordenTablon"+c]=r.tabOrden[c-1]),null!=r.tabKanban&&r.tabKanban[c-1]&&"null"!=r.tabKanban[c-1]&&(localStorage["tablonKanban"+c]=r.tabKanban[c-1]);localStorage.removeItem("errorConexion10000")}else clearInterval(intervalErrorConexion),intervalErrorConexion=setInterval(intentaConexion,1e4),l=s;localStorage.numTablones=l}n++}if(a>localStorage.numTablones){for(var d=parseInt(localStorage.numTablones);d<a;d++)null!=localStorage["fondo"+(d+1)]&&"undefined"!=localStorage["fondo"+(d+1)]||(localStorage["fondo"+(d+1)]=0);localStorage.numTablones=a}t&&sendMessage({mensBack:"muestraNotas"}),o?muestraNotasAlCompartir():inicializaInvitaciones(),localStorage.totalPost>0&&(cambiaIcono(),cambiaContador()),("-999"!=localStorage.tablonActual||!algunaNotaWeb())&&parseInt(localStorage.tablonActual)>parseInt(localStorage.numTablones)&&(localStorage.tablonActual=localStorage.numTablones)}function cargaNotasAdd(e,t,o){for(var a=localStorage.totalPost,n=new Array,i=!1,r=0,l=0;l<a;l++)n[l]=!1;e.mail&&(localStorage.mail=e.mail),e.espacio&&(localStorage.espacio=e.espacio),e.premium&&(localStorage.premium=e.premium);let s=0;for(;e[s];){if(null!=e[s].postit)if(e[s].tipoA!=TIPO_NOTA.TABLONES){var c=!1;for(l=0;l<a;l++)localStorage["postit"+l]==e[s].postit&&(n[l]=!0,c=!0);if(!c){var d=localStorage.totalPost;localStorage["tipoA"+d]=e[s].tipoA,localStorage["X"+d]=e[s].X,localStorage["Y"+d]=e[s].Y,localStorage["postit"+d]=e[s].postit,localStorage["width"+d]=e[s].width,localStorage["height"+d]="0"==e[s].height?"auto":e[s].height,localStorage["fecha"+d]=e[s].fecha,localStorage["tablon"+d]=e[s].tablon,localStorage["treeId"+d]=e[s].id_nota,localStorage["calendar"+d]=e[s].calendar,localStorage["sinMarco"+d]="1"==e[s].sinMarco,e[s].rotacion&&(localStorage["rotacion"+d]=e[s].rotacion),e[s].pushpin&&(localStorage["pushpin"+d]=e[s].pushpin),e[s].notaWeb&&(localStorage["notaWeb"+d]=e[s].notaWeb),e[s].columnaKanban&&(localStorage["columnaKanban"+d]=e[s].columnaKanban),e[s].connections&&(localStorage["connections"+d]=e[s].connections),e[s].minimizado&&"0"!=e[s].minimizado&&(localStorage["minimizado"+d]="1"==e[s].minimizado),parseInt(e[s].tablon)>r&&"-999"!=e[s].tablon&&(r=parseInt(e[s].tablon)),null!=e[s].permisos&&("RW"==e[s].permisos?localStorage["userComp"+d]=e[s].userComp:localStorage["userComp"+d]="R",localStorage["nickComp"+d]=e[s].nickComp,recuperaPosCompartido(d)),localStorage.totalPost++,t&&muestraPostit(d)}}else{localStorage.treeId10000=e[s].id_nota;try{var u=JSON.parse(e[s].postit)}catch(t){try{u=JSON.parse(e[s].postit.replace("\\",""))}catch(e){console.log(e);u={tabLabels:[]}}}var g=u.tabLabels.length,p=localStorage.numTablones;if(null==localStorage.errorConexion10000||g>p){for(var m=1;m<=g;m++)localStorage["tab"+m+"Label"]=u.tabLabels[m-1],localStorage["fondo"+m]=u.tabBgs[m-1],null!=u.tabPublico&&1==u.tabPublico[m-1]?localStorage["publico"+m]="true":localStorage["publico"+m]="false",null!=u.tabMasonry&&1==u.tabMasonry[m-1]?localStorage["masonry"+m]="true":localStorage["masonry"+m]="false",null!=u.tabOrden&&(localStorage["ordenTablon"+m]=u.tabOrden[m-1]),null!=u.tabKanban&&u.tabKanban[m-1]&&"null"!=u.tabKanban[m-1]&&(localStorage["tablonKanban"+m]=u.tabKanban[m-1]);localStorage.removeItem("errorConexion10000")}else clearInterval(intervalErrorConexion),intervalErrorConexion=setInterval(intentaConexion,1e4),g=p;(null==localStorage.numTablones||g>localStorage.numTablones)&&(localStorage.numTablones=g),i=!0}s++}if(localStorage.totalPost>0&&(cambiaIcono(),cambiaContador()),r>localStorage.numTablones){for(l=parseInt(localStorage.numTablones);l<r;l++)null!=localStorage["fondo"+(l+1)]&&"undefined"!=localStorage["fondo"+(l+1)]||(localStorage["fondo"+(l+1)]=0);localStorage.numTablones=r}addNotasNuevas(n,a,i),inicializaInvitaciones(),esTabCompartido(localStorage.tablonActual)?trataTablonComp():inicializaFriendsBot(),t&&refrescaPantalla(!1,!0)}function addNotasNuevas(e,t,o){if(!isDemoUser()){for(var a=new Array,n=0,i=0;i<t;i++)if(!e[i]){"undefined"!=localStorage["tablon"+i]&&null!=localStorage["tablon"+i]||(localStorage["tablon"+i]=1),null!=localStorage["sinMarco"+i]&&"undefined"!=localStorage["sinMarco"+i]||(localStorage["sinMarco"+i]="false");var r={tipoA:localStorage["tipoA"+i],X:localStorage["X"+i],Y:localStorage["Y"+i],postit:localStorage["postit"+i],width:localStorage["width"+i],height:localStorage["height"+i],fecha:localStorage["fecha"+i],tablon:localStorage["tablon"+i],calendar:localStorage["calendar"+i],sinMarco:localStorage["sinMarco"+i],rotacion:localStorage["rotacion"+i],pushpin:localStorage["pushpin"+i],notaWeb:localStorage["notaWeb"+i],columnaKanban:localStorage["columnaKanban"+i],connections:localStorage["connections"+i],minimizado:localStorage["minimizado"+i]};localStorage["updated"+i]="false",a[n]=r,n++}if(n>0){var l="id_usuario="+localStorage.id_usuario;l+="&token="+localStorage.token,l+="&listaNotas="+encodeURIComponent(JSON.stringify(a)),numIntentos=0,llamadaCreate(l,e,t,o)}else o?updateNotaLoginMemo(1e4):grabaNotaLogin(1e4)}}var numIntentos,numIntentosMod;function llamadaCreate(e,t,o,a){$.ajax({type:"POST",url:getServerUrl()+"api/createListNotes.php",data:e,cache:!1,success:function(e){var n=JSON.parse(e),i=0;if(n.isSuccess){n.espacio&&(localStorage.espacio=n.espacio);for(var r=0;r<o;r++)t[r]||(localStorage["treeId"+r]=n.idNota[i],addTreeIdPopup(n.idNota[i],r),addTreeIdConnection(n.idNota[i],r),addTreeIdKanban(n.idNota[i],r),$("#postit"+r).attr("data-treeId",n.idNota[i]),localStorage["postit"+r].indexOf("data:image/")>0&&null!=n.postit[i]&&(localStorage["postit"+r]=n.postit[i].replace(/<\/p>n<p>/gm,"</p>\n<p>"),refrescaNota(r)),i++);a?updateNotaLoginMemo(1e4):grabaNotaLogin(1e4)}else localStorage.sincroLogin=!1},error:function(e,a,n){console.log("Error llamadaCreate");for(var i=0;i<o;i++)t[i]||(manageConnectionError(i,"create",!1),errorConexion(i,"create"));muestraAyuda("mensErrorConexion")}})}function grabaModificaciones(){if(!isDemoUser()){for(var e=new Array,t=!1,o=0,a=0;a<localStorage.totalPost;a++)if("true"==localStorage["updated"+a]){if(t=!0,"undefined"!=localStorage["tablon"+a]&&null!=localStorage["tablon"+a]||(localStorage["tablon"+a]=1),null==localStorage["userComp"+a]||"R"==localStorage["userComp"+a])var n=localStorage.id_usuario;else n=localStorage["userComp"+a];null!=localStorage["sinMarco"+a]&&"undefined"!=localStorage["sinMarco"+a]||(localStorage["sinMarco"+a]="false");var i={id_nota:localStorage["treeId"+a],tipoA:localStorage["tipoA"+a],X:localStorage["X"+a],Y:localStorage["Y"+a],postit:localStorage["postit"+a],width:localStorage["width"+a],height:localStorage["height"+a],fecha:localStorage["fecha"+a],tablon:localStorage["tablon"+a],calendar:localStorage["calendar"+a],sinMarco:localStorage["sinMarco"+a],rotacion:localStorage["rotacion"+a],pushpin:localStorage["pushpin"+a],usuario:n,notaWeb:localStorage["notaWeb"+a],columnaKanban:localStorage["columnaKanban"+a],connections:localStorage["connections"+a],minimizado:localStorage["minimizado"+a]};localStorage["updated"+a]="false",e[o]=i,o++}if("true"==localStorage.updated10000){var r=new Array,l=new Array,s=new Array,c=new Array,d=new Array,u=new Array;for(a=1;a<=localStorage.numTablones;a++)null==localStorage["tab"+a+"Label"]&&(localStorage["tab"+a+"Label"]="undefined"),r.push(localStorage["tab"+a+"Label"]),l.push(localStorage["fondo"+a]),"true"==localStorage["publico"+a]?s.push(1):s.push(0),"true"==localStorage["masonry"+a]?d.push(1):d.push(0),c.push(ordenTablon(a)),localStorage["tablonKanban"+a]?u.push(localStorage["tablonKanban"+a]):u.push("");var g={tabLabels:r,tabBgs:l,tabPublico:s,tabOrden:c,tabMasonry:d,fuente:localStorage.fuente,size:localStorage.size,tabKanban:u};i={id_nota:localStorage.treeId10000,tipoA:TIPO_NOTA.TABLONES,X:0,Y:0,rotacion:"",postit:JSON.stringify(g),width:0,height:0,fecha:"",tablon:0,calendar:"",pushpin:"",sinMarco:!1,usuario:localStorage.id_usuario};e[o]=i,t=!0,localStorage.updated10000="false"}if(t){var p="id_usuario="+localStorage.id_usuario;p+="&token="+localStorage.token,p+="&listaNotas="+encodeURIComponent(JSON.stringify(e)),p+="&sid="+localStorage.sid,numIntentosMod=0,llamadaUpdate(p)}}}function llamadaUpdate(e){$.ajax({type:"POST",url:getServerUrl()+"api/updateListNotes4.php",data:e,cache:!1,success:function(e){var t=JSON.parse(e);t.isSuccess||console.log("Error:  "+t.error)},error:function(t,o,a){console.log(t),console.log("Error UpdateList"),++numIntentosMod<8?(console.log("Intento otra vez..."+numIntentosMod),setTimeout((function(){llamadaUpdate(e)}),1e4)):console.log("No quedan intentos, mala suerte")}})}function sendReportError(e,t,o){var a="id_usuario="+e;a+="&numPost="+t,a+="&nota="+o,a+="&localStorage="+escape(JSON.stringify(localStorage)),a+="&navigator="+encodeURIComponent(navigator.userAgent+"-"+navigator.platform+"-"+navigator.cookieEnabled+"-"+navigator.language),a+="&origen=extensión",$.ajax({type:"POST",url:getServerUrl()+"api/sendReport.php",data:a,cache:!1,success:function(e){},error:function(e,t,o){console.log(t)}})}function sendReportErrorGetNotes(){var e="stackTrace="+(new Error).stack;e+="&version="+chrome.runtime.getManifest().version,e+="&navigator="+encodeURIComponent(navigator.userAgent+"-"+navigator.platform+"-"+navigator.cookieEnabled+"-"+navigator.language),e+="&origen=extensión",$.ajax({type:"POST",url:getServerUrl()+"api/sendReportTrace.php",data:e,cache:!1,success:function(e){},error:function(e,t,o){console.log(t)}})}var intervalErrorConexion=0;function errorConexion(e,t){null==localStorage["errorConexion"+e]&&(localStorage["errorConexion"+e]=t,localStorage.refrescaNota=e,sendMessage({mensBack:"refrescaNota"}),clearInterval(intervalErrorConexion),intervalErrorConexion=setInterval(intentaConexion,1e4))}function intentaConexion(){var e=!1;if(isUserConnected()){for(var t=0;t<localStorage.totalPost;t++)e=reintentarSiError(t)||e;(e=reintentarSiError(1e4)||e)||clearInterval(intervalErrorConexion)}else clearInterval(intervalErrorConexion)}function reintentarSiError(e){var t=!1;if(null!=localStorage["errorConexion"+e])switch(t=!0,localStorage["errorConexion"+e]){case"create":grabaNotaLogin(e);break;case"update":e<1e4&&yaExisteNota(e)?grabaNotaLogin(e):updateNotaLogin(e)}return t}function yaExisteNota(e){for(var t=localStorage["treeId"+e],o=0;o<localStorage.totalPost;o++)if(t==localStorage["treeId"+o]&&o!=e)return!0;return!1}var intervalInv,tablonActual=1;function addNopubli(){$noPubli=$("#cansadoAnun"),$noPubli.length&&($noPubli.html(chrome.i18n.getMessage("quitaAnuncios")),$noPubli.on("click",(()=>muestraMensajeHaztePremium())))}function init(){if(idiomaEsp(navigator.language)){$(".idioma-castellano").show(),document.getElementById("titulo").innerHTML='<img src="appimg/NoteBoard.png" width="250" /> 8.0 <small>Información y opciones</small>';var e=`\n            <h1>Opciones</h1>\n                <div>\n                    <div class='cheksDerechos'>\n                        <input type='checkbox' id='slideCheck' name='icono' >Efecto "slide" al cambiar de tablón<br>\n                        <input type='checkbox' id='minimapCheck' name='icono' >Mostrar mini mapa en el tablón<br>\n                        <div id='opciones-ext'>\n                            <input type='checkbox' id='popupOption' name='icono'>Abrir extensión en un popup<br>\n                            <input type='checkbox' id='embedCheck' name='icono' checked>Conversión automática de links de youtube y pdf a videos y documentos insertados<br>\n                        </div>\n                    </div>\n                <div id='contElec'>\n                    <h4>Contador de notas en el Icono</h4>\n                    <input id='contador1' name='contador' type='radio' value='contador1' checked>Notas en tablón actual<BR>\n                    <input id='contador2' name='contador' type='radio' value='contador2'>Notas totales<BR>\n                    <input id='contador3' name='contador' type='radio' value='contador3'>Sin contador<BR>\n                </div>\n                <div class='grid-options'>\n                    <input id='grid-drag' name='grid-drag' type='checkbox'/> Alinear notas en una cuadrícula:\n                    <input class='grid-size' id='grid-x' type='number' value="50" maxlength="3" /> x\n                    <input class='grid-size' id='grid-y' type='number' value="50" maxlength="3" />\n                    <span class="grid-help" title="Cuando esta opción está habilitada, las notas se mueven por pasos, es útil para ordenar las notas más fácilmente">(ayuda)</sp>\n                </div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t${isChromeExtension()?`\n\t\t\t\t\t\t\t\t\t<div class="new-tab">\n\t\t\t\t\t\t\t\t\t\t<h3>Abrir como nueva pestaña</h3>\n\t\t\t\t\t\t\t\t\t\t<input id='new-tab' name='new-tab' type='checkbox'>Abrir como nueva pestaña\n\t\t\t\t\t\t\t\t\t\t${getSelectHtml({id:"listaTablones",label:"Tablón",options:listaTablones(!1,!0)})}\n\t\t\t\t\t\t\t\t\t\t<input id='new-tab-mini' name='new-tab-mini' type='checkbox'>Sin barra menús ni mini mapa\n\t\t\t\t\t\t\t\t\t</div>`:""}\n                <div id="mensCheck"><br><input id="sincPer" type="checkbox" NAME="Sinc"><b>Comprobar si hay notas nuevas creadas en otro ordenador</b> cada 10 min (también puedes sincronizar manualmente siempre que quieras desde el botón de perfil "Datos Usuario").<br><small>Esta opción sólo es útil si se usa la extensión en más de un ordenador al mismo tiempo o si estás compartiendo tablones. Actívalo sólo en caso necesario por favor</small></div>\n                <p>Si quieres puedes cambiar los atajos de teclado de la extensión en ${isEdgeExtension()?"edge://extensions/shortcuts":"chrome://extensions/shortcuts"}</p>\n                </div>`;"<li><b>7.5.4</b>: Botón de borrar tablón en vista previa de tablón.</li>",'<li><b>7.5.0</b>: Nuevo efecto "slide" en los cambio de tablones.</li>',"<li><b>7.4.60</b>: Nueva opción de backups.</li>","<li><b>7.4.26</b>: Nueva opción para duplicar nota.</li>","<li><b>7.4.0</b>: Modo presentación.</li>","<li><b>7.3.32</b>: Selección de temas.</li>","<li><b>7.3.21</b>: Añadida posibilidad de seleccionar texto manteniendo la tecla SHIFT.</li>","<li><b>7.3.0</b>: Sistema de avisos mejorado.</li>","<li><b>7.2.30</b>: Añdido codesample al editor.</li>","<li><b>7.2</b>: Nuevo formato de nota como libreta.</li>","<li><b>7.1.90</b>: Guardar contenido limpio de página web.</li>","<li><b>7.1.55</b>: Selección de notas múltiple.</li>","<li><b>7.1</b>: Ordenación automática.</li>","<li><b>7.0</b>: Notas en Web. Papelera.</li>","<li><b>6.1.7.8</b>: Tablones de tamaño infinito..</li>",'<li><b>6.1.7.0</b>: Posibilidad de añadir "chinchetas" a las notas..</li>',"<li><b>6.1.6.7</b>: Posibilidad de añadir contenido de una web a una nota arrastrando contenido desde otra pestaña.</li>","<li><b>6.1.6.4</b>: Posibilidad de arrastrar contenido de una web a una nota popup.</li>","<li><b>6.1.6.2</b>: Opción de borrar todas las notas antes de hacer login o al hacer logout.</li>","<li><b>6.1.5.2</b>: Añadida búsqueda por antigüedad de nota. Buscar &gt;num para buscar notas de más de num dias y &lt;num para buscarlas de menos de num dias.</li>","<li><b>6.1.4.8</b>: Nuevas fuentes.</li>","<li><b>6.1.4.6</b>: Traducción parcial al ruso. Corrección errores.</li>","<li><b>6.1.0</b>: Notas popup.</li>","<li><b>6.0.4.18</b>: Nuevo icono para rotar las notas. En cada nota verás un icono a la izquierda, arrástralo y la nota rotará.</li>","<li><b>6.0.4.17</b>: Añadidos shortcuts CTRL+S y CTRL+Q para guardar o cancelar la edición de una nota.</li>","<li><b>6.0.4.14</b>: Mejorada la herramienta de búsqueda.</li>","<li><b>6.0.4.0</b>: Herramienta para hacer zoom.</li>","<li><b>6.0.3.22</b>: Acceso HTTPS al servidor.</li>","<li><b>6.0.3.18</b>: Se añaden botón de pantalla completa en el editor.</li>","<li><b>6.0.3.12</b>: Se añaden notificaciones push para móviles.</li>","<li><b>6.0.2.27</b>: Añadido en el editor la posibilidad de insertar un checkbox.</li>","<li><b>6.0.2.22</b>: Arrastra ficheros de imágenes a un tablón para crear notas automáticamente con ellas.</li>","<li><b>6.0.2.18</b>: Añadida la posibilidad de cambiar el orden de los tablones moviendolos.</li>","<li><b>6.0.2.14</b>: Ahora es posible borrar también los primeros 5 tablones iniciales.</li>","<li><b>6.0.2.12</b>: Nueva posibilidad de crear notas arrastrando contenido de otras pestañas.</li>","<li><b>6.0.2.7</b>: Las notas se guardan en local las notas cuando no hay conexión.</li>","<li><b>6.0.2.2</b>: Se añade la posibilidad de compartir el tablón público incrustándolo con un iframe.</li>","<li><b>6.0.2.1</b>: Mejora en el tratamiento de pdf's. Se añade posibilidad de arrastrar la pantalla de el mini mapa.</li>","<li><b>6.0.1.0</b>: Se añade opción de mover en la nota y una ventana de información del perfil con un botón de sincronizar.</li>","<li><b>6.0.0.3</b>: Se añade la opción de fondo centrado y sin mosaico.</li>","<li><b>6.0.0.1</b>: Confirmación cuando se mueve una nota.</li>","<li><b>6.0</b>: Nuevo diseño, tablones públcos y notas sin marco.</li>","<li><b>5.0.3.5</b>: Corregidos pequeños errores.</li>","<li><b>5.0.3.0</b>: Se añade la sincronización de los fondos de pantalla.</li>","<li><b>5.0.2.7</b>: Se añade opción de crear una nota con imagen por URL y nueva versión 4.0.10 de tinyMce.</li>","<li><b>5.0.2.5 and 5.0.2.6</b>: Corrección de errores de poca importancia.</li>","<li><b>5.0.2.4</b>: Corrección de error al intentar editar varias notas al mismo tiempo.</li>","<li><b>5.0.2.3</b>: Nueva versión del editor TinyMce 4.</li>","</ul>";var t='<h3>Opción para crear popups con notas</h3>Haciendo click en el nuevo icono <img src="appimg/newtab.png"/> crearás una ventana popup con el contenido de la nota, con ella podrás hacer lo siguiente:<br><img id="promoScreen" src="appimg/screen.jpg"/><ul><li><b>Dejar visible una nota en el escritorio:</b> la nota permanecerá donde la dejes hasta que cierres su ventana. Cuando reinicies el ordenador la nota volverá a aparecer en el mismo lugar incluso antes de abrir el navegador (para ello se añadirá a las aplicaciones que se ejecutan en segundo plano).</li><li><b>Editar nota en popup</b>: Haciendo doble click en la nota o con el icono del lápiz puedes editar la nota dentro del popup.</li><li><b>Ir a la nota en Note Board:</b> si haces click en el icono <img src="appimg/enter.png"/> se abrirá la aplicación y mostrará la nota del popup.</li><li><b>Tamaño variable:</b> Puedes modificar el tamaño de la ventana, la nota en el tablón original no se alterará.</li><li><b>Programar aparición de popups:</b> posibilidad de programar aparición de notas como popup en un dia y hora determinados (icono <img src="appimg/calendar.png"/>).</li></ul><br>';$("#mensaje-donacion").text("Puedes donar la cantidad que quieras para contribuir al mantenimiento de la extensión"),$("#paypal-language").val("es_XC")}else{$(".idioma-ingles").show(),document.getElementById("titulo").innerHTML=chrome.i18n.getMessage("extName")+" 8.0 <small>Information and Options</small>";$("#formUserCab").html('<h3>Sigin <a href="https://www.noteboardapp.com">www.noteboardapp.com</a><br> to synchronize.</h3><p>You can also use the extension <b>without</b> registering or using synchronization markers.</p>');e=`<h1>Options</h1>\n            <div>\n                <div class='cheksDerechos'>\n                    <input type='checkbox' id='slideCheck' name='icono' >"Slide" effect when changing boards<br>\n                    <input type='checkbox' id='minimapCheck' name='icono' >Show minimap on the board<br>\n                    <div id='opciones-ext'>\n                        <input type='checkbox' id='popupOption' name='icono'>Open extension in popup<br>\n                        <input type='checkbox' id='embedCheck' name='icono' checked>Automatic conversion of youtube and pdf links to embed content<br>\n                    </div>\n                </div>\n                <div id='contElec'>\n                    <h4>Icon Note Counter</h4>\n                    <input id='contador1' name='contador' type='radio' value='contador1' checked>Notes in current board<BR>\n                    <input id='contador2' name='contador' type='radio' value='contador2'>Total notes<BR>\n                    <input id='contador3' name='contador' type='radio' value='contador3'>No counter<BR>\n                </div>\n                <div class='grid-options'>\n                    <input id='grid-drag' name='grid-drag' type='checkbox'>Snap notes to a grid:\n                    <input class='grid-size' id='grid-x' type='number' value="50" maxlength="3" /> x\n                    <input class='grid-size' id='grid-y' type='number' value="50" maxlength="3" />\n                    <span class="grid-help" title="When this option is enabled the notes are dragged in steps, it's useful to order it easily">(help)</sp>\n                  </div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t${isChromeExtension()?`\n\t\t\t\t\t\t\t\t\t<div class="new-tab">\n\t\t\t\t\t\t\t\t\t\t<h3>Open as new tab</h3>\n\t\t\t\t\t\t\t\t\t\t<input id='new-tab' name='new-tab' type='checkbox'>Open as new tab\n\t\t\t\t\t\t\t\t\t\t${getSelectHtml({id:"listaTablones",label:"Board",options:listaTablones(!1,!0)})}\n\t\t\t\t\t\t\t\t\t\t<input id='new-tab-mini' name='new-tab-mini' type='checkbox'>Without menu bar and mini map\n\t\t\t\t\t\t\t\t\t</div>`:""}\n\n                <div id="mensCheck"><input id="sincPer" type="checkbox" NAME="Sinc"><b>Check for new notes created in another computer every 10 min. (You can also sync manually whenever you want from the topbar button <i class="material-icons">refresh</i></b><br><small>). This option is only useful if the extension is used in more than one computer at a time, turn it on only if needed please.</small></div>\n                <p>If you want to change the extension shortcuts go to ${isEdgeExtension()?"edge://extensions/shortcuts":"chrome://extensions/shortcuts"}</p>\n            </div>`;"<li><b>7.5.4</b>: Remove board button in board thumbnail.</li>",'<li><b>7.5.0</b>: New "slide" effect when changing the board.</li>',"<li><b>7.4.60</b>: New backup/restore feature.</li>","<li><b>7.4.26</b>: New option to duplicate note.</li>","<li><b>7.4.0</b>: Slides mode.</li>","<li><b>7.3.32</b>: Selection of themes.</li>","<li><b>7.3.21</b>: Added possibility to select text by holding the SHIFT key.</li>","<li><b>7.3.0</b>: Schedule system improved.</li>","<li><b>7.2.4</b>: Added codesample to the editor.</li>","<li><b>7.2</b>: New note format as a notebook.</li>","<li><b>7.1.90</b>: Save clean content of a website.</li>","<li><b>7.1.55</b>: Multiple selection.</li>","<li><b>7.1.40</b>: Send notes by email.</li>","<li><b>7.1.29</b>: Image editor.</li>","<li><b>7.1</b>: Auto Arrange.</li>","<li><b>7.0</b>: Notes in websites. Trash bin..</li>","<li><b>6.1.7.8</b>: Boards with infinite size..</li>",'<li><b>6.1.7.0</b>: Ability to add "pushpins".</li>',"<li><b>6.1.6.7</b>: Ability to add content from a website to a note dragging from another tab.</li>","<li><b>6.1.6.4</b>: Ability to drag content from a website to a note popup.</li>","<li><b>6.1.6.2</b>: Now you can delete all the notes before login or logout (only local notes).</li>","<li><b>6.1.5.2</b>: Search by number of days old. Search &gt;num to search notes of more than num days and &lt;num to search less than num days.</li>","<li><b>6.1.4.8</b>: New fonts.</li>","<li><b>6.1.4.6</b>: Russian partial translation. Fix errors.</li>","<li><b>6.1.0</b>: Popup notes.</li>","<li><b>6.0.4.17</b>: New icon to rotate the notes. In each note you will see an icon on the left, drag it to rotate.</li>","<li><b>6.0.4.17</b>: Added shortcuts CTRL+S y CTRL+Q to save or cancel in the note editor.</li>","<li><b>6.0.4.14</b>: Improved search tool.</li>","<li><b>6.0.4.0</b>: Zoom's tool.</li>","<li><b>6.0.3.22</b>: HTTPS access to the server.</li>","<li><b>6.0.3.18</b>: New fullscreen button in the editor.</li>","<li><b>6.0.3.12</b>: Added push notifications for mobile.</li>","<li><b>6.0.2.27</b>: Added checkboxes in the editor</li>","<li><b>6.0.2.22</b>: Drag file images to create notes automatically.</li>","<li><b>6.0.2.18</b>: Now you can change the boards order dragging its name.</li>","<li><b>6.0.2.14</b>: Now you can remove too the firs 5 boards.</li>","<li><b>6.0.2.12</b>: New feature to create notes by dragging content from other tabs.</li>","<li><b>6.0.2.7</b>: Data saved locally when there is not internet connection</li>","<li><b>6.0.2.2</b>: possibility to share the public board with an embed iframe.</li>","<li><b>6.0.2.1</b>: Better pdf processing. Posibility to drag the screen of the mini map.</li>","<li><b>6.0.1.0</b>: Option to move the note and window profile information is added with a button to synchronize.</li>","<li><b>6.0.0.3</b>: Custom background wihtout repetitions.</li>","<li><b>6.0.0.1</b>: Confirmation when a note is moved.</li>","<li><b>6.0</b>: New design, public boards, notes without borders.</li>","<li><b>5.0.3.5</b>: Fixed little bugs.</li>","<li><b>5.0.3.0</b>: Now synchronization of backgrounds.</li>","<li><b>5.0.2.7</b>: New option to crear an imagen note with a URL and new tinyMCE version 4.0.10.</li>","<li><b>5.0.2.5 and 5.0.2.6</b>: Fixed litle bugs.</li>","<li><b>5.0.2.4</b>: Fixed bug when there are more than one editor opened at the same time.</li>","<li><b>5.0.2.3</b>: New editor versión TinyMce 4.</li>","</ul>";t='<h3>You can create popups with notes</h3><br>Double click the icon <img src="appimg/newtab.png"/> to create a popup window with the content of a note, you will be able to do the following:<img id="promoScreen" src="appimg/screen.jpg"/><ul><li><b>Leave a note visible on the desktop:</b> the note will remain on the desktop until you close the window. When you restart the computer the note will appear in the same place even before opening the browser (Note Board will be added to the applications running in the background).</li><li><b>Edit the note</b>: double clicking on the note or the pencil icon to edit the note inside the popup.</li><li><b>Go to the note in Note Board:</b> clicking in <img src="appimg/enter.png"/> the application will open and display the note.</li><li><b>Variable size: </b>you can resize the window, the note on the original board will not be altered.</li><li><b>Schedule popups:</b> you can schedule popup notes on a certain day and time with the actual schedule reminder tool (icon <img src="appimg/calendar.png"/>).</li></ul>Thanks for the idea Noga!  <img src="tinymce/plugins/emoticons/img/smiley-wink.gif"/><br>'}if($("#titulo-kanban").html(chrome.i18n.getMessage("demoUserKanban")),"true"==localStorage.confirmado&&"5"!=localStorage.id_usuario&&$("#promo2").hide(),document.getElementById("options").innerHTML=e,document.getElementById("newPopup").innerHTML=t,$(".grid-help").tooltipster({theme:["tooltipster-noir","tooltipster-noir-customized"],side:"right",delay:150,zIndex:99999999,maxWidth:300}),isChromeExtension()||($("#contElec, #opciones-ext").hide(),$(".cheksDerechos").removeClass("cheksDerechos")),null==localStorage.contador&&"undefined"==localStorage.contador||$("#contador"+localStorage.contador).attr("checked",!0),$(".social").jsocial({twitter:"oscardrbcn",facebook:"facebook.com/profile.php?id=100001706728205",center:!1,inline:!0}),$("#sincPer").click((function(){localStorage.sincPeriodico=$("#sincPer").is(":checked"),"true"==localStorage.sincPeriodico&&sendMessage({empiezaSincroPeriodica:!0})})),"true"==localStorage.sincPeriodico?$("#sincPer").attr("checked",!0):$("#sincPer").attr("checked",!1),$("#contElec").click((function(){var e=localStorage.contador;switch($("input[name='contador']:checked").val()){case"contador1":localStorage.contador="1";break;case"contador2":localStorage.contador="2";break;case"contador3":localStorage.contador="3"}e!=localStorage.contador&&cambiaContador()})),"true"!=localStorage.noEfectoSlide?$("#slideCheck").attr("checked",!0):$("#slideCheck").attr("checked",!1),$("#slideCheck").on("change",(function(){localStorage.noEfectoSlide=!$("#slideCheck").is(":checked")})),"true"!=localStorage.noMinimapa?$("#minimapCheck").attr("checked",!0):$("#minimapCheck").attr("checked",!1),$("#minimapCheck").on("change",(function(){localStorage.noMinimapa=!$("#minimapCheck").is(":checked"),sendMessage({mensBack:"cambiaMinimapa"})})),"false"!=localStorage.automaticEmbed?$("#embedCheck").attr("checked",!0):$("#embedCheck").attr("checked",!1),$("#embedCheck").on("change",(function(){localStorage.automaticEmbed=$("#embedCheck").is(":checked")})),"true"!=localStorage.fullScreen&&$("#popupOption").attr("checked",!0),$("#popupOption").on("change",(function(){localStorage.fullScreen=!$("#popupOption").is(":checked"),"true"!=localStorage.fullScreen?chrome.action.setPopup({popup:"popup.html"}):chrome.action.setPopup({popup:""})})),localStorage.seleccionTema&&"colorGris"!=localStorage.seleccionTema&&$("input:radio[value="+localStorage.seleccionTema+"]").prop("checked",!0),$("#seleccion-temas").click((function(e){e.target.className.indexOf("seleccion-color")>-1&&$(e.target).parent().find("input").prop("checked",!0);var t=localStorage.seleccionTema;localStorage.seleccionTema=$("input[name='seleccion-tema']:checked").val(),t!=localStorage.seleccionTema&&sendMessage({mensBack:"seleccionTemaMod"})})),localStorage["new-tab"]){$("#new-tab").attr("checked",!0);let e=getNewTab();e&&$("#new-tab").attr("checked",!0),e.hideBar&&$("#new-tab-mini").attr("checked",!0),$("#listaTablones").val(e.numTab)}else $("#new-tab").attr("checked",!1),$(".mdc-select").addClass("mdc-select--disabled"),$("#new-tab-mini").attr("disabled",!0);if($("#new-tab").on("change",(function(){chrome.permissions.request({permissions:["tabs"]},(function(e){e&&($("#new-tab").is(":checked")?($(".mdc-select").removeClass("mdc-select--disabled"),$("#new-tab-mini").attr("disabled",!1),setNewTab($("#listaTablones").val(),$("#new-tab-mini").is(":checked"))):(localStorage.removeItem("new-tab"),$(".mdc-select").addClass("mdc-select--disabled"),$("#new-tab-mini").attr("disabled",!0)))}))})),$(".mdc-select").on("MDCSelect:change",(function(){setNewTab($("#listaTablones").val(),$("#new-tab-mini").is(":checked"))})),$("#new-tab-mini").on("change paste keyup select",(function(){setNewTab($("#listaTablones").val(),$("#new-tab-mini").is(":checked"))})),localStorage["grid-drag"]){$("#grid-drag").attr("checked",!0);var o=getGridData();o&&($("#grid-x").val(o.x),$("#grid-y").val(o.y))}else $("#grid-drag").attr("checked",!1);$("#grid-drag").on("change",(function(){$("#grid-drag").is(":checked")?localStorage["grid-drag"]=$("#grid-x").val()+"x"+$("#grid-y").val():localStorage.removeItem("grid-drag"),sendMessage({mensBack:"refrescaPantalla"})})),$("#grid-x, #grid-y").on("change",(function(){$("#grid-drag").is(":checked")&&(localStorage["grid-drag"]=$("#grid-x").val()+"x"+$("#grid-y").val())})),isChromeExtension()&&initMaterializeComponents()}function botonPermisos(){if(idiomaEsp(navigator.language))var e='<div id="permisosBut" class="button">Dar permisos para acceder a imágenes externas en notificaciones o fondos</div>';else e='<div id="permisosBut" class="button">Give permissions for external images in notifications and backgrounds</div>';$("#contElec").append(e),$("#permisosBut").on("click",(function(){chrome.permissions.request({origins:["http://*/*","https://*/*"]},(function(e){e?$("#permisosBut").remove():console.log("no concedido")}))}))}function inicializaInvitaciones(){invitacionesPorTratar()&&($("#invitacionesBot").show(),$("#compBot").attr("title",chrome.i18n.getMessage("compartir")),$("#invitacionesBot").attr("title",chrome.i18n.getMessage("invitacionesBot")),intervalInv=setInterval(parpadeaBotonInv,300))}function muestraNotasAlCompartir(){refrescaPantalla(null,!0),inicializaInvitaciones(),esTabCompartido(tablonActual)?trataTablonComp():inicializaFriendsBot(),muestraPaneles2(),cambiaIcono(),cambiaContador()}function esTablonCompartido(e){if(!isUserConnected()||!localStorage.comparticiones)return!1;for(var t=JSON.parse(localStorage.comparticiones),o=0;o<t.length&&t[o].tabComp!=e;)o++;return o<t.length}function getTablonCompartido(e){if(!isUserConnected()||!localStorage.comparticiones)return!1;for(var t=JSON.parse(localStorage.comparticiones),o=0;o<t.length&&t[o].tabComp!=e;)o++;return o<t.length&&t[o]}function comparteTablon(){if(!salSiPapelera())if(isUserConnected()){var e=obtenerFormularioInvitar();$("#listaTablones option").sortElements((function(e,t){return parseInt($(e).attr("orden"))>parseInt($(t).attr("orden"))?1:-1})),abrirPantallaModal(e,{onOpenStart:function(){$("#enviar-compartir").off().on("click",compartir),$("#pedir-url").off().on("click",pedirUrlCompartir)},height:700})}else muestraAdvertenciaLogin("hayQueLoguearse")}function compartir(){if(!isDemoUser()){var e=$("#userInvitado").val();if(""==e)return $("#userInvitado").focus(),void(idiomaEsp(navigator.language)?muestraMensajeModal("Informa el usuario al que quieres invitar por favor"):muestraMensajeModal("Informs the user that you want to invite please"));if(e!=localStorage.nick)if(-1==e.indexOf("@")&&yaCompartido(e,parseInt($("#listaTablones").val())))idiomaEsp(navigator.language)?muestraMensajeModal("Tablón ya compartido con "+e):muestraMensajeModal("Board already shared with "+e);else if(e.indexOf("@")>-1&&!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\D{2,4})+$/.test(e))idiomaEsp(navigator.language)?muestraMensajeModal("Mail con formato incorrecto"):muestraMensajeModal("Wrong mail");else{muestraMensajeModal(""),$("#enviar-compartir i").addClass("loader");var t=$("#onlyRead").is(":checked")?"R":"RW",o="id_usuario="+localStorage.id_usuario;o+="&token="+localStorage.token,o+="&permisos="+t,o+="&userInvitado="+encodeURIComponent(e),o+="&nombreInvitador="+encodeURIComponent($("#nombreInvitador").val()),o+="&tablon="+parseInt($("#listaTablones").val()),o+="&textoCompartir="+encodeURIComponent($("#textoCompartir").val()),$.ajax({type:"POST",url:getServerUrl()+"api/invitar.php",data:o,cache:!1,success:function(o){var a=JSON.parse(o);$("#mensError").html(a.mens),a.isSuccess&&(addInvEnviadas(e,a.id_usuarioInv,parseInt($("#listaTablones").val()),$("#textoCompartir").val(),t),$("#dialog-confirm").fadeOut(1e3,(function(){modalInstance.close()})))},error:function(e,t,o){console.log(t)},complete:function(){$("#enviar-compartir i").removeClass("loader")}})}else idiomaEsp(navigator.language)?muestraMensajeModal("No puedes compartir contigo mismo, escribe el nombre de usuario o mail del usuario al que quieres invitar"):muestraMensajeModal("You can not share with yourself, type the user name or mail the user you want to invite")}}function pedirUrlCompartir(){if(!isDemoUser()){$("#pedir-url i").addClass("loader");var e="id_usuario="+localStorage.id_usuario;e+="&tablon="+parseInt($("#listaTablones").val()),e+="&permisos="+($("#onlyRead").is(":checked")?"R":"RW"),$.ajax({type:"POST",url:getServerUrl()+"api/getUrlShare.php",data:e,cache:!1,success:function(e){var t=JSON.parse(e);t.isSuccess?($("#url-generada").val(t.url),document.getElementById("url-generada").select(),document.execCommand("copy"),window.getSelection().empty()):muestraMensajeModal(chrome.i18n.getMessage("errorShareUrl"))},error:function(e,t,o){muestraMensajeModal(chrome.i18n.getMessage("errorShareUrl"))},complete:function(){$("#pedir-url i").removeClass("loader")}})}}function anularInvitacion(){var e=parseInt($(this).attr("id").substr(7)),t=JSON.parse(localStorage.invEnviadas),o="id_usuario1="+localStorage.id_usuario;o+="&id_usuario2="+t[e].id_usuario2,o+="&mail2="+t[e].mail,o+="&tablon1="+t[e].tablon,$.ajax({type:"POST",url:getServerUrl()+"api/anularInv.php",data:o,cache:!1,success:function(t){var o=JSON.parse(t);if(o.isSuccess){var a=JSON.parse(localStorage.invEnviadas);a.splice(e,1),localStorage.invEnviadas=JSON.stringify(a),0==a.length?$("#tablaInvEnviadas").fadeOut():$("#lineaInv"+e).fadeOut((function(){$("#contenedorTabla").html(tablaInvitacionesEnviadas())}))}else alert(o.error)},error:function(e,t,o){console.log(t)}})}function recibeInvitaciones(e){for(var t=0;t<e.length;t++)e.tratada=!1,e.aceptada=!1;localStorage.invitaciones=JSON.stringify(e)}function recibeInvEnviadas(e){localStorage.invEnviadas=JSON.stringify(e)}function recibeComparticiones(e){for(var t=[],o=0;o<e.length;o++)contieneComp(e[o],t)||(t.push(e[o]),e[o].tabKanban&&(localStorage["tablonKanban"+e[o].tabComp]=JSON.stringify(e[o].tabKanban)));localStorage.comparticiones=JSON.stringify(t)}function muestraInvitaciones(){if(clearInterval(intervalInv),$("#invitacionesBot").css("background","linear-gradient(bottom, #E3B752 6%, #FFDC73 35%, #FFFF96 73%)"),invitacionesPorTratar()>0){var e=JSON.parse(localStorage.invitaciones),t='<div class="invitaciones">';t+='<div id="listaInv"><ul>';for(var o=0;o<e.length;o++)e[o].tratada||(t+='<li id="invitacion'+o+'">',t+=chrome.i18n.getMessage("user")+":<p> "+e[o].user,t+=' - <a href="mailto:'+e[o].mail+'">'+e[o].mail+"</a></p><br>",t+=chrome.i18n.getMessage("mensaje")+":<p> "+e[o].mensaje+"</p><br>","RW"==e[o].permisos?t+=chrome.i18n.getMessage("permisos")+": <p>"+chrome.i18n.getMessage("escLec")+"</p><br>":t+=chrome.i18n.getMessage("permisos")+": <p>"+chrome.i18n.getMessage("lec")+"</p><br>",t+=`<div class="input-field"><p>${chrome.i18n.getMessage("eligeTablonDestino")}</p>\n            <div class="input-field">\n              ${getSelectHtml({id:"listaTablones",label:chrome.i18n.getMessage("elijeDestino"),options:listaTablones(isAddBoardPremiumAllowed())})}\n            </div>\n          </div>`,t+='<button type="button" class="rechazarInv btn waves-effect waves-light red lighten-2" id="rechazarInv'+o+'">'+chrome.i18n.getMessage("rechazar")+"</button>",t+='<button type="button" class="aceptarInv accept-btn btn waves-effect waves-light" id="aceptarInv'+o+'">'+chrome.i18n.getMessage("aceptar")+"</button>",t+="<hr></li>");t+='</ul></div><div id="ajaxAnswer"></div></div>',$("#dialog-confirm").attr("title",chrome.i18n.getMessage("extName")),$("#dialog-confirm").html(t),$("#listaTablones option").sortElements((function(e,t){return parseInt($(e).attr("orden"))>parseInt($(t).attr("orden"))?1:-1})),abrirPantallaModal(t,{onOpenStart:function(){$("#enviar-compartir").on("click",compartir),$(".aceptarInv").on("click",aceptarInv),$(".rechazarInv").on("click",rechazarInv)},header:{title:chrome.i18n.getMessage("invitacionesPend")},buttons:{cancelButton:!0},height:580})}}function aceptarInv(){if(!isDemoUser()){var e=parseInt($(this).attr("id").substr(10)),t=JSON.parse(localStorage.invitaciones),o="id_usuario1="+t[e].id_usuario1;o+="&id_usuario2="+localStorage.id_usuario,o+="&nick1="+t[e].user,o+="&nick2="+localStorage.nick,o+="&tablon1="+t[e].tablon,o+="&tablon2="+$("#listaTablones").val(),o+="&token="+t[e].token,$("#ajaxAnswer").html('<img src="appimg/ajax-loader.gif"/>'),$.ajax({type:"POST",url:getServerUrl()+"api/aceptarInv.php",data:o,cache:!1,success:function(t){var o=JSON.parse(t);if(o.isSuccess){var a=JSON.parse(localStorage.invitaciones);a[e].tratada=!0,a[e].aceptada=!0,localStorage.invitaciones=JSON.stringify(a),parseInt($("#listaTablones").val())>parseInt(localStorage.numTablones)?(addBoard(),sweetAlert({type:"info",text:chrome.i18n.getMessage("newSharedBoard",[nombreTablon($("#listaTablones").val()),a[e].user]),cancel:!1,successCallback:function(){clickTablon(null,!1,$("#listaTablones").val())}})):sweetAlert({type:"info",text:chrome.i18n.getMessage("sharedBoard",[nombreTablon($("#listaTablones").val()),a[e].user]),cancel:!1}),localStorage.sincPeriodico="true",sendMessage({empiezaSincroPeriodica:!0}),grabaModificaciones(),sincronizaLogin(!1,!0,!0),0==invitacionesPorTratar()?($("#dialog-confirm").fadeOut(1400,(function(){modalInstance.close()})),$("#invitacionesBot").hide()):$("#invitacion"+e).remove()}else $("#ajaxAnswer").html(o.error);$("#ajaxAnswer").html("")},error:function(e,t,o){console.log(t)}})}}function rechazarInv(){var e=parseInt($(this).attr("id").substr(11)),t=JSON.parse(localStorage.invitaciones),o="id_usuario1="+t[e].id_usuario1;o+="&id_usuario2="+localStorage.id_usuario,o+="&nick1="+t[e].user,o+="&nick2="+localStorage.nick,o+="&tablon1="+t[e].tablon,o+="&token="+t[e].token,$.ajax({type:"POST",url:getServerUrl()+"api/rechazarInv.php",data:o,cache:!1,success:function(t){var o=JSON.parse(t);if(o.isSuccess){var a=JSON.parse(localStorage.invitaciones);a[e].tratada=!0,a[e].aceptada=!1,localStorage.invitaciones=JSON.stringify(a),0==invitacionesPorTratar()?($("#dialog-confirm").fadeOut(1400,(function(){modalInstance.close()})),$("#invitacionesBot").hide()):$("#invitacion"+e).remove()}else alert(o.error)},error:function(e,t,o){console.log(t)}})}function updateCompartido(e,t){if(!isDemoUser()){for(var o=JSON.parse(localStorage.comparticiones),a=0;a<o.length;a++)o[a].tabComp==e&&(o[a].tabComp=t);localStorage.comparticiones=JSON.stringify(o);var n="id_usuario="+localStorage.id_usuario;n+="&numTablon="+e,n+="&numNuevo="+t,$.ajax({type:"POST",url:getServerUrl()+"api/updateCompartir.php",data:n,cache:!1,success:function(e){var t=JSON.parse(e);t.isSuccess?console.log("success"):alert(t.error)},error:function(e,t,o){console.log(t)}})}}function deleteTablonCompartido(e,t){if(!isDemoUser()){var o="id_usuario="+localStorage.id_usuario;o+="&numTablon="+e,$.ajax({type:"POST",url:getServerUrl()+"api/deleteTablonCompartido.php",data:o,cache:!1,success:function(e){var t=JSON.parse(e);t.isSuccess?inicializaFriendsBot():alert(t.error)},error:function(e,t,o){console.log(t)}})}}function borrarCompartir(){var e=$(this).attr("id").substr(14);sweetAlert({text:chrome.i18n.getMessage("confirmarCompartirTab"),successCallback:function(){borrarCompartirConfirmado(e)},type:"warning"})}function borrarCompartirConfirmado(e){if(!isDemoUser()){var t=JSON.parse(localStorage.comparticiones),o="id_usuario="+localStorage.id_usuario;o+="&idUserComp="+t[e].id_usuarioComp,o+="&numTablon="+t[e].tabComp;var a=t[e].tabComp;$.ajax({type:"POST",url:getServerUrl()+"api/deleteCompartir.php",data:o,cache:!1,success:function(t){var o=JSON.parse(t);if(o.isSuccess){var n=JSON.parse(localStorage.comparticiones);n.splice(e,1),localStorage.comparticiones=JSON.stringify(n),esTabCompartido(a)?muestraUsuariosComp(null,!0):inicializaFriendsBot(),grabaModificaciones(),sincronizaLogin(!1,!0,!0),0==n.length&&localStorage.removeItem("comparticiones")}else console.log(o.error)},error:function(e,t,o){console.log(t)}})}}$(document).ready((function(){addNopubli(),tablonActual=localStorage.tablonActual||1,init(),idiomaEsp(navigator.language)?$("#correoEng").remove():$("#correoEsp").remove(),idiomaEsp(navigator.language)?$("#tweeterBut").append('<a href="https://twitter.com/share" class="twitter-share-button" data-url="https://chrome.google.com/webstore/detail/goficmpcgcnombioohjcgdhbaloknabb" data-text="Prueba esta fantástica extensión de Chrome para guardar notas y no olvidarte de nada." data-count="horizontal"  data-lang="es">Tweet</a>'):($("#fb-button span").text("Log in with Facebook"),$("#tweeterBut").append('<a href="https://twitter.com/share" class="twitter-share-button" data-url="https://chrome.google.com/webstore/detail/goficmpcgcnombioohjcgdhbaloknabb" data-text="Try out this fantastic Chrome extension to keep notes and do not forget anything." data-count="horizontal"  data-lang="en">Tweet</a>'))}));var modalInstance,numParp=0;function parpadeaBotonInv(){numParp++,"rgb(231, 91, 44)"==$("#invitacionesBot").css("background-color")?$("#invitacionesBot").css("background","linear-gradient(bottom, #E3B752 6%, #FFDC73 35%, #FFFF96 73%)"):$("#invitacionesBot").css("background","#E75B2C"),30==numParp&&(clearInterval(intervalInv),$("#invitacionesBot").css("background",""),$("#invitacionesBot").css("background-color",""))}function inicializaFriendsBot(){$("#friendsBot").hide(),$(".nicksComp").hide()}function trataTablonComp(){$("#friendsBot").show()}function muestraUsuariosComp(e,t){if(t||!$(".nicksComp").is(":visible")){for(var o='<div id="usuariosComp">'+chrome.i18n.getMessage("compartidoCon")+"</div>",a=JSON.parse(localStorage.comparticiones),n=0;n<a.length;n++)a[n].tabComp==tablonActual&&(o+='<div class="nickComp" id="nick'+n+'">'+a[n].nickComp,o+='<img class="borraCompartir" id="borraCompartir'+n+'"src="appimg/removeWhite.png">',o+='<label class="permCompartir">'+chrome.i18n.getMessage(a[n].permisos)+" </label>",o+="</div>");$(".nicksComp").html(o),$("#borraCompartir").attr("title",chrome.i18n.getMessage("borraCompartir")),$(".borraCompartir").on("click",borrarCompartir);var i=$("#friendsBot").position().left+$(".nicksComp").width();$(".nicksComp").css({top:$("#friendsBot").height(),left:i>window.innerWidth?$("#friendsBot").position().left-(i+10-window.innerWidth):$("#friendsBot").position().left}),$(".nicksComp").fadeIn()}else $(".nicksComp").fadeOut();e&&e.stopPropagation(),closePaneles("nicksComp")}function contieneComp(e,t){for(var o=0;o<t.length;o++)if(t[o].id_usuarioComp==e.id_usuarioComp&&t[o].tabComp==e.tabComp&&t[o].permisos==e.permisos)return!0;return!1}function invitacionesPorTratar(){if(null==localStorage.invitaciones)return 0;for(var e=JSON.parse(localStorage.invitaciones),t=0,o=0;o<e.length;o++)e[o].tratada||t++;return t}function yaCompartido(e,t){if(null==localStorage.comparticiones)return!1;for(var o=JSON.parse(localStorage.comparticiones),a=0;a<o.length;a++)if(o[a].nickComp==e&&o[a].tabComp==t)return!0;return!1}function esTabCompartido(e=tablonActual){if(null==localStorage.comparticiones||!isUserConnected())return!1;for(var t=JSON.parse(localStorage.comparticiones),o=0;o<t.length;o++)if(t[o].tabComp==e)return!0;return!1}function getTablonCompartidoLocal(e){if(!localStorage.comparticiones||!isUserConnected())return-1;for(var t=JSON.parse(localStorage.comparticiones),o=0;o<t.length;o++)if(t[o].tabCompRemoto==e)return t[o].tabComp;return-1}function esNotaCompartida(e){return!!localStorage["userComp"+e]}function borraComparticion(e){for(var t=JSON.parse(localStorage.comparticiones),o=0;o<t.length;o++)t[o].tabComp==e&&t.splice(o,1);localStorage.comparticiones=JSON.stringify(t)}function selectDeTablones(e,t){var o='<select id="listaTablones">';e?"0"!=tablonActual&&(o+='<option orden="'+ordenTablon(tablonActual)+'" value="'+tablonActual+'">'+nombreTablon(tablonActual)+"</option>"):o+='<option value="'+(parseInt(localStorage.numTablones)+1)+'">'+chrome.i18n.getMessage("labelAdd")+"</option>";for(var a=1;a<=localStorage.numTablones;a++)e&&a==tablonActual||(o+='<option orden="'+ordenTablon(a)+'" value="'+a+'">'+nombreTablon(a)+"</option>");return esNotaWeb(t)&&(o+='<option value="-999">'+nombreTablon(-999)+"</option>"),o+="</select>"}function listaTablones(e=!1,t=!1){var o,a=[];t&&a.push({text:chrome.i18n.getMessage("ultimoTablonActual"),value:0,orden:0,selected:!0}),e&&a.push({text:chrome.i18n.getMessage("labelAdd"),value:parseInt(localStorage.numTablones)+1});for(var n=1;n<=localStorage.numTablones;n++)a.push({text:nombreTablon(n),value:n,orden:parseInt(ordenTablon(n)),selected:0!=tablonActual||t?tablonActual==n:1==n});return algunaNotaWeb()&&a.push({text:nombreTablon(-999),value:"-999",orden:9999,selected:"-999"==tablonActual}),a.sort((o="orden",(e,t)=>e[o]>t[o]?1:t[o]>e[o]?-1:0))}function tablaInvitacionesEnviadas(){var e="";if(null==localStorage.invEnviadas)return e;var t=JSON.parse(localStorage.invEnviadas);if(0==t.length)return e;e="<table>",e+="<tr>",e+="<th>"+chrome.i18n.getMessage("tablon")+"</th>",e+="<th>"+chrome.i18n.getMessage("user")+"</th>",e+="<th>"+chrome.i18n.getMessage("permisos")+"</th>",e+="<th>"+chrome.i18n.getMessage("anular")+"</th>",e+="</th>";for(var o=0;o<t.length;o++)e+='<tr id="lineaInv'+o+'" title="'+t[o].mensaje+'">',null!=localStorage["tab"+t[o].tablon+"Label"]&&"undefined"!=localStorage["tab"+t[o].tablon+"Label"]?e+="<td>"+localStorage["tab"+t[o].tablon+"Label"]+"</td>":e+="<td>"+chrome.i18n.getMessage("tablon")+t[o].tablon+"</td>",""!=t[o].user?e+="<td>"+t[o].user+"</td>":t[o].mail.indexOf("@")>0?e+="<td>"+t[o].mail+"</td>":e+="<td>Facebook</td>",e+="<td>"+chrome.i18n.getMessage(t[o].permisos)+"</td>",e+='<td><button class="anulInvBut waves-effect waves-light btn-small teal lighten-2" id="anulInv'+o+'">'+chrome.i18n.getMessage("anularBot")+"</button></td>",e+="</tr>";return e+="</table>"}function addInvEnviadas(e,t,o,a,n){if(null==localStorage.invEnviadas)var i=new Array;else i=JSON.parse(localStorage.invEnviadas);var r={mail:e.indexOf("@")>-1?e:"",mensaje:a,permisos:n,tablon:o,user:-1==e.indexOf("@")?e:"",id_usuario2:t};i.push(r),localStorage.invEnviadas=JSON.stringify(i)}function eliminaCompartidos(){for(var e=0;e<localStorage.totalPost;)null!=localStorage["userComp"+e]?borrarConfirmado(e,!0):e++;localStorage.removeItem("comparticiones"),localStorage.removeItem("invitaciones"),localStorage.removeItem("invEnviadas"),inicializaFriendsBot()}function showAjaxGif(){$("#black_overlay").show()}function hideAjaxGif(){$("#black_overlay").hide()}function guardaPosCompartido(e){posCompartidas["X"+localStorage["treeId"+e]]=localStorage["X"+e],posCompartidas["Y"+localStorage["treeId"+e]]=localStorage["Y"+e]}function recuperaPosCompartido(e){null!=posCompartidas["X"+localStorage["treeId"+e]]&&(localStorage["X"+e]=posCompartidas["X"+localStorage["treeId"+e]],localStorage["Y"+e]=posCompartidas["Y"+localStorage["treeId"+e]])}function loginFacebook(){chrome.permissions.request({permissions:["tabs"],origins:["https://www.noteboardapp.com/"]},(function(e){e&&(chrome.runtime.sendMessage({loginFace:"login"}),FBNb.init("339270982866129"),FBNb.login(),FBNb.api("picture",(function(e){console.log("kkk"),console.log(e)})))}))}function getFBDataLogin(){FBNb.api("me?fields=id,name,friends,email",(function(e){}))}function abrirPantallaModal(e,t){t.zindex=t.zindex||1e7;var o=t.dialogElement||"dialog-confirm";if(t.buttons&&(e=anyadirBotonesYIcono(e,t.buttons,t.icon,t.center)),t.header&&(e=anyadirHeader(e,t.header)),$("#"+o).html(e),M.Modal.init(document.getElementById(o),{onOpenStart:function(){$(".modal-overlay").css("z-index",t.zindex),$(".botones, .tablonPostits").addClass("blur-effect"),$("#"+o).css({"z-index":t.zindex+1}),t.height&&$(".modal.modal-fixed-footer").height(t.height),t.width&&$(".modal.modal-fixed-footer").width(t.width),t.maxWidth&&$(".modal.modal-fixed-footer").css("max-width",t.maxWidth),t.maxHeight&&$(".modal.modal-fixed-footer").css("max-height",t.maxHeight),t.minHeight&&$(".modal.modal-fixed-footer").css("min-height",t.minHeight),t.onOpenStart&&t.onOpenStart(),$("select").formSelect(),initMaterializeComponents(),t.buttons&&asignaCallbacksBotones(t.buttons)},onOpenEnd:function(){M.updateTextFields(),$(".modal-overlay").css("z-index",t.zindex),$(".btn-crea-nota").hide(),t.height&&$(".modal.modal-fixed-footer").height(t.height),t.width&&$(".modal.modal-fixed-footer").width(t.width),t.maxHeight&&$(".modal.modal-fixed-footer").css("max-height",t.maxHeight),t.onOpenEnd&&t.onOpenEnd(),t.icon&&$(".modal-content").css("top","0"),activarClaseActivaInputs(),$("#movilAdd").length>0&&$(".modal").addClass("adds-movil"),isMobile()&&(window.location.hash="modal")},onCloseEnd:function(){t.onCloseEnd&&t.onCloseEnd(),$(".botones, .tablonPostits").removeClass("blur-effect"),$(".btn-crea-nota").show(),isMobile()&&(window.location.hash="")},opacity:.5}),t.newModalInstance){var a=M.Modal.getInstance(document.getElementById(o));return a.open(),a}(modalInstance=M.Modal.getInstance(document.getElementById(o))).open()}function anyadirHeader(e,t){return`\n    <div class="modal-header">\n      <div class="title-container">\n        ${t.icon?`<i class="material-icons icono">${t.icon}</i>`:""}\n        <h4 class="modal-title">${t.title}</h4>\n      </div>\n    </div>\n    ${e}\n    `}function anyadirBotonesYIcono(e,t,o,a){var n="",i="";if(t.list)for(var r=0;r<t.list.length;r++)n+=`<button class="btn waves-effect waves-light ${t.list[r].color?t.list[r].color:"grey darken-1"} " id="button${r}">${t.list[r].text}</button>`;if(o){var l="";switch(o){case"info":l='<span class="swal2-icon-text">i</span>';break;case"question":l='<span class="swal2-icon-text">x</span>';break;case"error":l='<span class="swal2-x-mark"><span class="swal2-x-mark-line-left"></span><span class="swal2-x-mark-line-right"></span></span>'}i=`<div class="swal2-icon swal2-${o} swal2-animate-${o}-icon" style="display: flex;">${l}</div>`}return`\n    <div class="modal-content modal-custom ${a?"center":""}">\n      ${i}\n      ${e}\n    </div>\n    <div class="modal-footer">\n      ${n}\n      ${t.cancelButton?`<a href="#!" class="modal-close waves-effect waves-gray btn-flat grey-text text-darken-2" id="cancelar-fondo">${chrome.i18n.getMessage("cancelar")}</a>`:""}\n    </div>`}function asignaCallbacksBotones(e){if(e.list)for(var t=0;t<e.list.length;t++)$("#button"+t).on("click",e.list[t].callback)}function sweetAlert(e){swal({html:e.text,type:e.type||"question",buttonsStyling:!1,width:e.width,confirmButtonText:e.confirmText||chrome.i18n.getMessage("aceptar"),confirmButtonClass:e.confirmButtonClass||"btn waves-effect waves-light grey darken-1",showCancelButton:!1!==e.cancel,cancelButtonText:e.cancelText||chrome.i18n.getMessage("cancelar"),cancelButtonClass:"btn waves-effect waves-light black-text grey lighten-3",backdrop:"rgba(0,0,0,0.7)",onOpen:function(){$(".botones, .tablonPostits").addClass("blur-effect"),e.text.length>400&&$(".swal2-popup #swal2-content").addClass("leftAlign")},onClose:function(){$(".botones, .tablonPostits").removeClass("blur-effect")}}).then((function(t){t.value?e.successCallback&&e.successCallback():e.cancelCallback&&e.cancelCallback()}))}function initMaterializeComponents(){const e=document.querySelectorAll(".mdc-text-field"),t=document.querySelectorAll(".mdc-select");for(const t of e)if($(t).find("input").length>0||$(t).find("textarea").length>0)try{mdc.textField.MDCTextField.attachTo(t)}catch(e){console.log(e)}for(const e of t)try{mdc.select.MDCSelect.attachTo(e),$(e).find(".mdc-notched-outline__notch").width("auto")}catch(e){console.log(e)}}function openSnackbar({text:e="",action:t="",action2:o="",action2Callback:a=(()=>{}),actionCallback:n=(()=>{}),dismiss:i=!0,dismissCallback:r=(()=>{}),stacked:l=!1,timeout:s=0}={}){var c=`<div class="mdc-snackbar ${l?"mdc-snackbar--stacked":""}" id="mdc-snackbar">\n    <div class="mdc-snackbar__surface">\n    <div class="mdc-snackbar__label"\n      role="status"\n      aria-live="polite">\n      ${e}\n    </div>\n    <div class="mdc-snackbar__actions">\n      ${o?`<button type="button" id="mdc-snackbar_action2" class="mdc-button mdc-snackbar__action2">${o}</button>`:""}\n      ${t?`<button type="button" class="mdc-button mdc-snackbar__action">${t}</button>`:""}\n      ${i?'<button type="button" class="mdc-icon-button mdc-snackbar__dismiss material-icons">close</button>':""}\n    </div>\n      </div>\n    </div>`;$("body").append(c);var d=document.getElementById("mdc-snackbar"),u=new(0,mdc.snackbar.MDCSnackbar)(d);s&&(u.timeoutMs=s),u.open(),o&&$("#mdc-snackbar_action2",d).on("click",(()=>{isFunction(a)&&a()})),d.addEventListener("MDCSnackbar:closed",(e=>{switch(e.detail.reason){case"action":isFunction(n)&&n();break;case"dismiss":isFunction(r)&&r()}$("#mdc-snackbar").remove()}))}function muestraMensajeModal(e){$(".mensaje-modal").text(e).fadeOut(500).fadeIn(500)}function getInputHtml({id:e,label:t,type:o,icon:a,helperLine:n}){return`\n    <div class="mdc-text-field nb-full-width mdc-text-field--outlined mdc-text-field--with-leading-icon">\n    ${a?'<i class="material-icons mdc-text-field__icon">'+a+"</i>":""}\n    <input id="${e}" type=${o} name="${e}" class="mdc-text-field__input" />\n    <div class="mdc-notched-outline">\n      <div class="mdc-notched-outline__leading"></div>\n      <div class="mdc-notched-outline__notch">\n        <label class="mdc-floating-label">${t}</label>\n      </div>\n      <div class="mdc-notched-outline__trailing"></div>\n    </div>\n  </div>\n  ${n?'<div class="mdc-text-field-helper-line"><div class="mdc-text-field-helper-text">'+n+"</div></div>":""}\n  `}function getOptionsHtml(e){let t="";for(const o of e)t+=`<li class="mdc-list-item ${o.selected?"mdc-list-item--selected":""}" data-value="${o.value}">\n                ${o.text}\n            </li>`;return t}function getSelectHtml({id:e,label:t,options:o}){return`<div class="mdc-select mdc-select--outlined nb-select-width">\n  <input id="${e}" type="hidden" name="${e}">\n  <i class="mdc-select__dropdown-icon"></i>\n  <div class="mdc-select__selected-text"></div>\n  <div class="mdc-select__menu mdc-menu mdc-menu-surface nb-select-width">\n    <ul class="mdc-list">\n      ${getOptionsHtml(o)}\n    </ul>\n  </div>\n  <div class="mdc-notched-outline">\n    <div class="mdc-notched-outline__leading"></div>\n    <div class="mdc-notched-outline__notch">\n      <label class="mdc-floating-label mdc-floating-label--float-above" style="">${t}</label>\n    </div>\n    <div class="mdc-notched-outline__trailing"></div>\n  </div>\n  </div>`}function activarClaseActivaInputs(){$("input[type=text], input[type=password], input[type=email], input[type=url], input[type=tel], input[type=number], input[type=search], input[type=date], input[type=time], textarea",".modal-content").each((function(e,t){$(this).val()&&($(this).parent().find(".mdc-notched-outline").addClass("mdc-notched-outline--notched"),$(this).parent().find("label").addClass("mdc-floating-label--float-above"))}))}function muestraAyudaSnackbar(e){"false"!=localStorage[e]&&openSnackbar({text:chrome.i18n.getMessage(e),action:chrome.i18n.getMessage("noMostrarMas"),actionCallback:()=>{localStorage[e]="false"}})}function showNewFeature(e,t,o){"false"!=localStorage[e]&&(o?abrirPantallaModal(chrome.i18n.getMessage(e),{icon:"info",buttons:{cancelButton:!0,list:[{text:chrome.i18n.getMessage("masInfo"),callback:function(){chrome.tabs.create({url:"https://www.noteboardapp.com/"+t}),localStorage[e]="false",modalInstance.close()}},{text:chrome.i18n.getMessage("noMostrarMas"),callback:function(){localStorage[e]="false",modalInstance.close()}}]},height:500,width:750}):openSnackbar({text:chrome.i18n.getMessage(e),action:chrome.i18n.getMessage("noMostrarMas"),action2:chrome.i18n.getMessage("masInfo"),action2Callback:()=>{chrome.tabs.create({url:"https://www.noteboardapp.com/"+t})},actionCallback:()=>{localStorage[e]="false"},stacked:!0,timeout:8e3}))}function muestraAyuda(e,t="info"){"false"!=localStorage[e]&&sweetAlert({type:t,text:chrome.i18n.getMessage(e),confirmText:chrome.i18n.getMessage("noVolverMostrar"),cancel:!0,cancelText:chrome.i18n.getMessage("aceptar"),successCallback:function(){localStorage[e]="false"}})}async function promptFields(e={}){return await Swal.fire({title:e.title||"no title",input:e.inputType||"text",showCancelButton:!0})}function getCalendarDateModal(){return new Promise((e=>{abrirPantallaModal(obtenerFormularioCalendarPlugin(),{onOpenStart:function(){var t=new Date;$("#datepicker").val(t.getDate()+"."+(t.getMonth()+1)+"."+t.getFullYear()+" "+t.getHours()+":"+t.getMinutes()),jQuery("#datepicker").datetimepicker({format:"d.m.Y H:i",inline:!0,step:5,minDate:0,dayOfWeekStart:1}),$.datetimepicker.setLocale(window.navigator.language||navigator.browserLanguage),$("#accept-date").off().on("click",(()=>{const t=$("#datepicker").datetimepicker("getValue").toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1});e({dismiss:!1,value:t}),modalInstance.close()}))},width:350,maxHeight:"450px",minHeight:"450px",dialogElement:"dialog-calendar"})}))}!function(){var e="https://graph.facebook.com/v4.0/",t="",o={_uid:"",init:function(e,o){e,t=o||""},getUser:function(e){o.api("/me",(function(t){t&&t.id&&(localStorage._uid=t.id,o._uid=t.id,e&&e(t))}))},getMissingPermissions:function(e){var a=[];o.api("me/permissions",(function(o){if(o&&!o.error&&o.data&&o.data[0]){for(var n=t.replace(/\s/g,"").split(","),i=0;i<n.length;i++)n[i]in o.data[0]||n[i]in{friends_checkins:1,user_checkins:1,friends_status:1,user_status:1,offline_access:1}||a.push(n[i]);e&&e(a)}}))},getAccessToken:function(){if(null==localStorage.fbToken)return!1;var e=((new Date).getTime()-localStorage.timeLogin)/1e3;return console.log("Time Loged: "+e/60+" minutes"),console.log("Time to expire: "+localStorage.fbExpires/60+" minutes"),!(e>localStorage.fbExpires)&&localStorage.fbToken},setAccessToken:function(e){!1===e?localStorage.removeItem("fbToken"):localStorage.fbToken=e},getUserID:function(){return localStorage._uid||o._uid},login:function(){window.open("https://www.facebook.com/dialog/oauth?client_id=339270982866129&response_type=token&redirect_uri=http://www.facebook.com/connect/login_success.html&scope=email","Facebook Login","width=900,height=500,left=200,top=150,scrollbars=no")},inviteFriends:function(e,t,o,a,n,i){e=e.substring(0,60);var r="https://www.facebook.com/dialog/apprequests?app_id=339270982866129&message="+encodeURIComponent(e)+"&display=popup&redirect_uri=https://www.noteboardapp.com/api/sendRequestFb.php?invitation="+t+"|"+o+"|"+a+"|"+n+"|"+i;window.open(r,"Invite Friends","width=800,height=500,left=100,top=100,scrollbars=no")},api:function(t){var a=Array.prototype.slice.call(arguments,1),n=!1,i={},r="get";for(var l in a)switch(typeof a[l]){case"function":n=a[l];break;case"object":i=a[l];break;case"string":r=a[l].toLowerCase()}if(!t&&!i.batch)return n&&n(!1);i.method=r,i.access_token=this.getAccessToken(),$.get(e+t,i,(function(e){e&&e.error&&e.error.type&&("Invalid OAuth access token."==e.error.message||e.error.message.indexOf("Error validating access token")>-1)?o.login():"function"==typeof n&&n(e)}),"json")},objectFromURL:function(e){if(-1==e.indexOf("facebook.com"))return e},setFbObject:function(e){o.fbObject=e},feed:function(e,t){var o="https://www.facebook.com/dialog/feed?app_id=339270982866129&link="+encodeURIComponent(e)+"&name="+encodeURIComponent(document.title)+"&display=popup&description="+encodeURIComponent(t)+"&redirect_uri=http://www.zocalosquare.com/api/sendRequestFb.php";window.open(o,"Publish","width=600,height=500,left=200,top=100,scrollbars=no")}};window.FBNb=o}();